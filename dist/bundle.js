(()=>{"use strict";eval('\n;// CONCATENATED MODULE: ./model/answerDetails.js\nclass AnswerDetails {\n    constructor(answerTime, isAnswered, answer, score) {\n        this.answerTime = answerTime;\n        this.isAnswered = isAnswered;\n        this.answer = answer;\n        this.score = score;\n    }\n}\n;// CONCATENATED MODULE: ./service/questionsFetcher.js\nclass QuestionsFetcher {\n    async fetchQuestions(questionsNum, category, difficulty) {\n        const apiURL = `https://opentdb.com/api.php?amount=${questionsNum}&category=${category}&difficulty=${difficulty}&type=multiple`;\n        return fetch(apiURL)\n            .then(response => response.json()) \n            .then(data=>{\n                return data.results;\n            })\n            .catch(error => alert(error));\n    }\n}\n;// CONCATENATED MODULE: ./model/question.js\nclass Question {\n    constructor(responseObj) {\n        this.category = responseObj.category;\n        this.type = responseObj.type;\n        this.difficulty = responseObj.difficulty;\n        this.question = responseObj.question;\n        this.correctAnswer = responseObj.correct_answer;\n        this.incorrectAnswers = responseObj.incorrect_answers;\n        this.answerDetails = {};\n    }\n\n    setAnswerDetails(answerDetails) {\n        this.answerDetails = answerDetails;\n    }\n}\n;// CONCATENATED MODULE: ./service/categoriesFetcher.js\nclass CategoriesFetcher {\n    async fetchCategories() {\n        const apiURL = "https://opentdb.com/api_category.php";\n        return fetch(apiURL)\n            .then(response => response.json()) \n            .then(data=>{\n                return data.trivia_categories;\n            })\n            .catch(error => {\n                alert(error);\n                return null;\n            });\n    }\n}\n;// CONCATENATED MODULE: ./ui/elementsCreator.js\nconst summaryAnswersDiv = document.getElementById("answersSummary");\nconst questionForm = document.forms["questionForm"];\n\nclass ElementsCreator {\n    createRadioBox(answer, id) {\n        let radiobox = document.createElement(\'input\');\n        radiobox.id = id;\n        radiobox.type = \'radio\';\n        radiobox.value = answer;\n        radiobox.name = "answer"\n        return radiobox;\n    }\n\n    createLabel(answer, id) {\n        const label = document.createElement(\'label\')\n        label.htmlFor = id;\n        const description = document.createTextNode(answer);\n        label.appendChild(description);\n        return label;\n    }\n\n    createAnswerGroup(radiobox, label) {\n        const answerGroup = document.createElement("div");\n        answerGroup.classList.add("answerGroup");\n        answerGroup.appendChild(radiobox);\n        answerGroup.appendChild(label);\n        return answerGroup;\n    }\n\n    createAnswers(allAnswers) {\n        let radioboxId = 0;\n        allAnswers.forEach(answer => {\n            const radiobox = this.createRadioBox(answer, radioboxId);\n            const label = this.createLabel(answer, radioboxId);\n            const answerGroup = this.createAnswerGroup(radiobox, label);\n            questionForm.appendChild(answerGroup);\n            radioboxId++;\n        });\n    }\n\n    createAnswersSummary(questions) {\n        questions.forEach(question => {\n            const scoreSectionScore = this.createScoreSection("Score:", question.answerDetails.score);\n            const answerTime = question.answerDetails.answerTime;\n            const scoreSectionTime = this.createScoreSection("Time:", `${Math.floor(answerTime/1000)}s`);\n            const summaryInfo = this.createSummaryInfo(scoreSectionScore, scoreSectionTime);\n            const answerDetails = this.createAnswerDetails(summaryInfo, question);\n            summaryAnswersDiv.appendChild(answerDetails);\n        });\n        \n    }\n\n    createAnswerDetails(summaryInfo, question) {\n        const answerDetails = this.getDiv("summaryDiv", "");\n        answerDetails.appendChild(this.getDiv("question", question.question));\n        answerDetails.appendChild(this.getHr());\n        answerDetails.appendChild(this.getDiv("question", "Your answer: " + question.answerDetails.answer));\n        answerDetails.appendChild(this.getHr());\n        answerDetails.appendChild(this.getDiv("question", "Correct answer: " + question.correctAnswer));\n        answerDetails.appendChild(this.getHr());\n        answerDetails.appendChild(summaryInfo);\n        return answerDetails;\n    }\n\n    createSummaryInfo(sectionScore, sectionTime) {\n        const summaryInfo = this.getDiv("summaryInfoDiv", "");\n        summaryInfo.appendChild(sectionScore);\n        summaryInfo.appendChild(sectionTime);\n        return summaryInfo;\n    }\n\n    createScoreSection(labelName, value) {\n        const label = this.getLabel(labelName);\n        const valueDiv = this.getDiv("answerScore", value);\n        const scoreSection = this.getDiv("scoreSection", "");\n        scoreSection.appendChild(label);\n        scoreSection.appendChild(valueDiv);\n        return scoreSection;\n    }\n\n    getHr() {\n        return document.createElement("hr");\n    }\n\n    getDiv(className, innerHTML) {\n        const div = document.createElement("div");\n        div.classList.add(className);\n        div.innerHTML = innerHTML;\n        return div;\n    }\n\n    getLabel(innerHTML) {\n        const label = document.createElement("label");\n        label.innerHTML = innerHTML;\n        return label;\n    }\n}\n;// CONCATENATED MODULE: ./ui/userInterface.js\n\n\n\nconst categories = document.getElementById("category");\nconst questionsNum = document.getElementById("quantity");\nconst properties = document.getElementById("properties");\nconst progressBar = document.getElementById("progressBar");\nconst questionsDiv = document.getElementById("questions");\nconst questionDiv = document.getElementById("question");\nconst summaryDiv = document.getElementById("summary");\nconst userInterface_summaryAnswersDiv = document.getElementById("answersSummary");\nconst userInterface_questionForm = document.forms["questionForm"];\nconst timerDiv = document.getElementById("timer");\n\nclass UserInterface {\n    constructor() {\n        this.categoriesFetcher = new CategoriesFetcher();\n        this.elementsCreator = new ElementsCreator();\n        this.timerSec = 1;\n    }\n\n    async populateCategories() {\n        await this.categoriesFetcher.fetchCategories()\n            .then(response => {response.forEach(obj => {\n                const option = document.createElement("option");\n                option.text = obj.name;\n                option.value = obj.id;\n                categories.add(option);\n            });\n        });\n    }\n\n    populateQuestionNums() {\n        for(let i=5; i<26; i++) {\n            const option = document.createElement("option");\n            option.text = i;\n            option.value = i;\n            if(i==10) option.selected ="selected";\n            questionsNum.add(option);\n        }\n    }\n\n    preparePropertiesScreen() {\n        properties.classList.remove("hide");\n        summaryDiv.classList.add("hide");\n        userInterface_summaryAnswersDiv.classList.add("hide");\n        userInterface_summaryAnswersDiv.innerHTML = "";\n    }\n\n    prepareQuestionScreen() {\n        properties.classList.add("hide");\n        progressBar.classList.remove("hide");\n        questions.classList.remove("hide");\n    }\n\n    prepareQuestionsScreenWhenReplay() {\n        summaryDiv.classList.add("hide");\n        userInterface_summaryAnswersDiv.classList.add("hide");\n        userInterface_summaryAnswersDiv.innerHTML = "";\n    }\n\n    prepareSummaryScreen(questions, gameDetails) {\n        progressBar.classList.add("hide");\n        questionsDiv.classList.add("hide");\n        summaryDiv.classList.remove("hide");\n        userInterface_summaryAnswersDiv.classList.remove("hide");\n        this.elementsCreator.createAnswersSummary(questions);\n        this.displayGameDetails(gameDetails);\n    }\n\n    showQuestion(question, questionNum, currentQuestionNum) {\n        questionDiv.innerHTML = question.question;\n        const allAnswers = this.getAllAnswers(question);\n        userInterface_questionForm.innerHTML = "";\n        this.elementsCreator.createAnswers(allAnswers);\n        this.increseProgressBar(questionNum, currentQuestionNum)\n    }\n\n    increseProgressBar(questionNum, currentQuestionNum) {\n        const progressValue = document.getElementById("progressValue");\n        const calculatedWidth = (currentQuestionNum / questionNum) * 100;\n        const widthValue = calculatedWidth + "%";\n        progressValue.style.width = widthValue;\n    }\n\n    shuffleArray(array) {\n        for (let i = array.length - 1; i > 0; i--) {\n            let j = Math.floor(Math.random() * (i + 1));\n            let temp = array[i];\n            array[i] = array[j];\n            array[j] = temp;\n        }\n    }\n\n    getAllAnswers(question) {\n        const allAnswers = question.incorrectAnswers;\n        allAnswers.push(question.correctAnswer);\n        this.shuffleArray(allAnswers);\n        return allAnswers;\n    }\n\n    getSelectedRadioValue() {\n        let selectedAnswer = "";\n        userInterface_questionForm["answer"].forEach(answer => {\n            if(answer.checked) selectedAnswer = answer.value;\n        });\n        if(selectedAnswer === "") alert("Please select an answer or skip the question.")\n        return selectedAnswer;\n    }\n\n    displayGameDetails(gameDetails) {\n        const totalScore = document.getElementById("totalScore");\n        const totalTime = document.getElementById("totalTime");\n        const timeInMilis = gameDetails.totalTimer.getMilisecondsFromStart();\n        const timeInsSec = Math.floor(timeInMilis/1000);\n        totalScore.innerHTML = gameDetails.totalScore;\n        totalTime.innerHTML = `${Math.floor(timeInsSec/60)}:${timeInsSec%60}`;\n    }\n\n    startQuestionTimer() {\n        const minutes = Math.floor(this.timerSec/60);\n        timerDiv.innerHTML = minutes + ":" + this.timerSec%60;\n        this.timerSec ++;\n    }\n}\n;// CONCATENATED MODULE: ./game/timer.js\nclass Timer {\n    constructor() {\n        this.start = new Date();\n    }\n\n    getMilisecondsFromStart() {\n        let stop = new Date();\n        return stop.getTime() - this.start.getTime();\n    }\n}\n;// CONCATENATED MODULE: ./model/gameDetails.js\n\n\nclass GameDetails {\n    constructor() {\n        this.totalTimer = new Timer();\n        this.totalScore = 0;\n    }\n}\n;// CONCATENATED MODULE: ./game/game.js\n\n\n\n\n\n\n\nconst propertiesForm = document.forms["propertiesForm"];\nconst bonusTime = 5000;\n\nclass Game {\n    constructor() {\n        this.questions = [];\n        this.currentQuestionNum = -1;\n        this.userInterface = new UserInterface();\n        this.questionFetcher = new QuestionsFetcher();\n        this.questionTimer = {};\n        this.gameDetails = {};\n    }\n\n    startGame() {\n        this.userInterface.populateCategories();\n        this.userInterface.populateQuestionNums();\n    }\n\n    playAgain() {\n        this.prepareToNewGame();\n        this.submitProperties();\n        this.userInterface.prepareQuestionsScreenWhenReplay();\n    }\n\n    startNewGame() {\n        this.prepareToNewGame();\n        this.userInterface.preparePropertiesScreen();\n    }\n\n    prepareToNewGame() {\n        this.questions = [];\n        this.currentQuestionNum = -1;\n    }\n        \n    async submitProperties() {\n        this.gameDetails = new GameDetails();\n        const questionsNum = propertiesForm["quantity"].value;\n        const category = propertiesForm["category"].value;\n        const difficulty = propertiesForm["difficulty"].value;\n        await this.saveQuestions(questionsNum, category, difficulty);\n        this.userInterface.prepareQuestionScreen();\n        this.loadNextQuestion();\n    }\n\n    async saveQuestions(questionsNum, category, difficulty) {\n        await this.questionFetcher.fetchQuestions(questionsNum, category, difficulty)\n            .then(response => {\n                response.forEach(obj => {\n                    this.questions.push(new Question(obj));\n            });\n        });\n    }\n\n    loadNextQuestion() {\n        if(this.currentQuestionNum < this.questions.length) {\n            this.currentQuestionNum ++;\n            this.userInterface.showQuestion(this.questions[this.currentQuestionNum], this.questions.length, this.currentQuestionNum);\n            this.startTimer();\n            this.prepareVisibleTimer();\n        }\n    }\n\n    prepareVisibleTimer() {\n        this.userInterface.timerSec = 1;\n        const timerDiv = document.getElementById("timer");\n        timerDiv.innerHTML = "0:0";\n    }\n\n    startTimer() {\n        this.questionTimer = new Timer();\n    }\n\n    startVisibleTimer() {\n        this.userInterface.startQuestionTimer();\n    }\n\n    answer(isAnswered) {\n        const answer = this.getAnswer(isAnswered);\n        const isAnswerNotChecked = (isAnswered && answer =="");\n        if(!isAnswerNotChecked) {\n            this.setAnswerDetails(isAnswered, answer);\n            this.setTotalScore();\n            this.loadNextScreen();\n        }\n    }\n\n    setAnswerDetails(isAnswered, answer) {\n        const time = this.questionTimer.getMilisecondsFromStart();\n        const correctAnswer = this.questions[this.currentQuestionNum].correctAnswer;\n        let score = this.getScore(isAnswered, answer, correctAnswer, time);\n        const answerDetails = new AnswerDetails(time, isAnswered, answer, score);\n        this.questions[this.currentQuestionNum].setAnswerDetails(answerDetails);\n    }\n\n    getAnswer(isAnswered) {\n        let answer = "";\n        if(isAnswered) answer = this.userInterface.getSelectedRadioValue();\n        return answer;\n    }\n\n    getScore(isAnswered, answer, correctAnswer, time) {\n        let score = 0;\n        if(isAnswered) score = this.calculateScore(answer, correctAnswer, time);\n        return score;\n    }\n\n    setTotalScore() {\n        const currentQuestion = this.questions[this.currentQuestionNum];\n        const currentQuestionScore = currentQuestion.answerDetails.score;\n        this.gameDetails.totalScore += currentQuestionScore;\n    }\n\n    loadNextScreen() {\n        const lastQuestionNum = this.questions.length - 1;\n        if(this.currentQuestionNum < lastQuestionNum) this.loadNextQuestion();\n        else {\n            this.userInterface.prepareSummaryScreen(this.questions, this.gameDetails);\n        }\n    }\n\n    calculateScore(answer, correctAnswer, time) {\n        let score = 0;\n        if(answer === correctAnswer) {\n            score += 1;\n            if(time < bonusTime) score += 0.5;\n        } else score -= 0.25;\n        \n        return score;\n    }\n}\n;// CONCATENATED MODULE: ./quizGame.js\n\n\nconst playButton = document.getElementById("playButton");\nconst answerButton = document.getElementById("answerButton");\nconst skipButton = document.getElementById("skipButton");\nconst playAgainButton = document.getElementById("playAgainButton");\nconst newGameButton = document.getElementById("newGameButton");\n\nfunction startGame() {\n    const game = new Game();\n    game.startGame();\n    playButton.addEventListener("click", () => game.submitProperties());\n    answerButton.addEventListener("click", () => game.answer(true));\n    skipButton.addEventListener("click", () => game.answer(false));\n    playAgainButton.addEventListener("click", () => game.playAgain());\n    newGameButton.addEventListener("click", () => game.startNewGame());\n    const questionTimer = setInterval(() => game.startVisibleTimer(), 1000);\n}\n\nstartGame();//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9xdWl6Z2FtZS8uL21vZGVsL2Fuc3dlckRldGFpbHMuanM/NjU1NiIsIndlYnBhY2s6Ly9xdWl6Z2FtZS8uL3NlcnZpY2UvcXVlc3Rpb25zRmV0Y2hlci5qcz83NDk1Iiwid2VicGFjazovL3F1aXpnYW1lLy4vbW9kZWwvcXVlc3Rpb24uanM/NmVhYiIsIndlYnBhY2s6Ly9xdWl6Z2FtZS8uL3NlcnZpY2UvY2F0ZWdvcmllc0ZldGNoZXIuanM/NGQ4NiIsIndlYnBhY2s6Ly9xdWl6Z2FtZS8uL3VpL2VsZW1lbnRzQ3JlYXRvci5qcz81YzJhIiwid2VicGFjazovL3F1aXpnYW1lLy4vdWkvdXNlckludGVyZmFjZS5qcz82N2NhIiwid2VicGFjazovL3F1aXpnYW1lLy4vZ2FtZS90aW1lci5qcz85Yzg2Iiwid2VicGFjazovL3F1aXpnYW1lLy4vbW9kZWwvZ2FtZURldGFpbHMuanM/Y2Y2OCIsIndlYnBhY2s6Ly9xdWl6Z2FtZS8uL2dhbWUvZ2FtZS5qcz82ZDg0Iiwid2VicGFjazovL3F1aXpnYW1lLy4vcXVpekdhbWUuanM/MWRjZiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQzs7QUNQZTtBQUNmO0FBQ0EsNkRBQTZELGFBQWEsWUFBWSxTQUFTLGNBQWMsV0FBVztBQUN4SDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsQzs7QUNWZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxDOztBQ2RlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLEM7O0FDYkE7QUFDQTs7QUFFZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FB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QUFrQyxhQUFhO0FBQy9DO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBLEM7O0FDeEkrQjs7QUFFL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHFCQUFxQixJQUFJO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEiLCJmaWxlIjoiNDQyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQW5zd2VyRGV0YWlscyB7XG4gICAgY29uc3RydWN0b3IoYW5zd2VyVGltZSwgaXNBbnN3ZXJlZCwgYW5zd2VyLCBzY29yZSkge1xuICAgICAgICB0aGlzLmFuc3dlclRpbWUgPSBhbnN3ZXJUaW1lO1xuICAgICAgICB0aGlzLmlzQW5zd2VyZWQgPSBpc0Fuc3dlcmVkO1xuICAgICAgICB0aGlzLmFuc3dlciA9IGFuc3dlcjtcbiAgICAgICAgdGhpcy5zY29yZSA9IHNjb3JlO1xuICAgIH1cbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBRdWVzdGlvbnNGZXRjaGVyIHtcbiAgICBhc3luYyBmZXRjaFF1ZXN0aW9ucyhxdWVzdGlvbnNOdW0sIGNhdGVnb3J5LCBkaWZmaWN1bHR5KSB7XG4gICAgICAgIGNvbnN0IGFwaVVSTCA9IGBodHRwczovL29wZW50ZGIuY29tL2FwaS5waHA/YW1vdW50PSR7cXVlc3Rpb25zTnVtfSZjYXRlZ29yeT0ke2NhdGVnb3J5fSZkaWZmaWN1bHR5PSR7ZGlmZmljdWx0eX0mdHlwZT1tdWx0aXBsZWA7XG4gICAgICAgIHJldHVybiBmZXRjaChhcGlVUkwpXG4gICAgICAgICAgICAudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS5qc29uKCkpIFxuICAgICAgICAgICAgLnRoZW4oZGF0YT0+e1xuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhLnJlc3VsdHM7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKGVycm9yID0+IGFsZXJ0KGVycm9yKSk7XG4gICAgfVxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFF1ZXN0aW9uIHtcbiAgICBjb25zdHJ1Y3RvcihyZXNwb25zZU9iaikge1xuICAgICAgICB0aGlzLmNhdGVnb3J5ID0gcmVzcG9uc2VPYmouY2F0ZWdvcnk7XG4gICAgICAgIHRoaXMudHlwZSA9IHJlc3BvbnNlT2JqLnR5cGU7XG4gICAgICAgIHRoaXMuZGlmZmljdWx0eSA9IHJlc3BvbnNlT2JqLmRpZmZpY3VsdHk7XG4gICAgICAgIHRoaXMucXVlc3Rpb24gPSByZXNwb25zZU9iai5xdWVzdGlvbjtcbiAgICAgICAgdGhpcy5jb3JyZWN0QW5zd2VyID0gcmVzcG9uc2VPYmouY29ycmVjdF9hbnN3ZXI7XG4gICAgICAgIHRoaXMuaW5jb3JyZWN0QW5zd2VycyA9IHJlc3BvbnNlT2JqLmluY29ycmVjdF9hbnN3ZXJzO1xuICAgICAgICB0aGlzLmFuc3dlckRldGFpbHMgPSB7fTtcbiAgICB9XG5cbiAgICBzZXRBbnN3ZXJEZXRhaWxzKGFuc3dlckRldGFpbHMpIHtcbiAgICAgICAgdGhpcy5hbnN3ZXJEZXRhaWxzID0gYW5zd2VyRGV0YWlscztcbiAgICB9XG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2F0ZWdvcmllc0ZldGNoZXIge1xuICAgIGFzeW5jIGZldGNoQ2F0ZWdvcmllcygpIHtcbiAgICAgICAgY29uc3QgYXBpVVJMID0gXCJodHRwczovL29wZW50ZGIuY29tL2FwaV9jYXRlZ29yeS5waHBcIjtcbiAgICAgICAgcmV0dXJuIGZldGNoKGFwaVVSTClcbiAgICAgICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHJlc3BvbnNlLmpzb24oKSkgXG4gICAgICAgICAgICAudGhlbihkYXRhPT57XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGEudHJpdmlhX2NhdGVnb3JpZXM7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKGVycm9yID0+IHtcbiAgICAgICAgICAgICAgICBhbGVydChlcnJvcik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9KTtcbiAgICB9XG59IiwiY29uc3Qgc3VtbWFyeUFuc3dlcnNEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFuc3dlcnNTdW1tYXJ5XCIpO1xuY29uc3QgcXVlc3Rpb25Gb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJxdWVzdGlvbkZvcm1cIl07XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEVsZW1lbnRzQ3JlYXRvciB7XG4gICAgY3JlYXRlUmFkaW9Cb3goYW5zd2VyLCBpZCkge1xuICAgICAgICBsZXQgcmFkaW9ib3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuICAgICAgICByYWRpb2JveC5pZCA9IGlkO1xuICAgICAgICByYWRpb2JveC50eXBlID0gJ3JhZGlvJztcbiAgICAgICAgcmFkaW9ib3gudmFsdWUgPSBhbnN3ZXI7XG4gICAgICAgIHJhZGlvYm94Lm5hbWUgPSBcImFuc3dlclwiXG4gICAgICAgIHJldHVybiByYWRpb2JveDtcbiAgICB9XG5cbiAgICBjcmVhdGVMYWJlbChhbnN3ZXIsIGlkKSB7XG4gICAgICAgIGNvbnN0IGxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGFiZWwnKVxuICAgICAgICBsYWJlbC5odG1sRm9yID0gaWQ7XG4gICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoYW5zd2VyKTtcbiAgICAgICAgbGFiZWwuYXBwZW5kQ2hpbGQoZGVzY3JpcHRpb24pO1xuICAgICAgICByZXR1cm4gbGFiZWw7XG4gICAgfVxuXG4gICAgY3JlYXRlQW5zd2VyR3JvdXAocmFkaW9ib3gsIGxhYmVsKSB7XG4gICAgICAgIGNvbnN0IGFuc3dlckdyb3VwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgYW5zd2VyR3JvdXAuY2xhc3NMaXN0LmFkZChcImFuc3dlckdyb3VwXCIpO1xuICAgICAgICBhbnN3ZXJHcm91cC5hcHBlbmRDaGlsZChyYWRpb2JveCk7XG4gICAgICAgIGFuc3dlckdyb3VwLmFwcGVuZENoaWxkKGxhYmVsKTtcbiAgICAgICAgcmV0dXJuIGFuc3dlckdyb3VwO1xuICAgIH1cblxuICAgIGNyZWF0ZUFuc3dlcnMoYWxsQW5zd2Vycykge1xuICAgICAgICBsZXQgcmFkaW9ib3hJZCA9IDA7XG4gICAgICAgIGFsbEFuc3dlcnMuZm9yRWFjaChhbnN3ZXIgPT4ge1xuICAgICAgICAgICAgY29uc3QgcmFkaW9ib3ggPSB0aGlzLmNyZWF0ZVJhZGlvQm94KGFuc3dlciwgcmFkaW9ib3hJZCk7XG4gICAgICAgICAgICBjb25zdCBsYWJlbCA9IHRoaXMuY3JlYXRlTGFiZWwoYW5zd2VyLCByYWRpb2JveElkKTtcbiAgICAgICAgICAgIGNvbnN0IGFuc3dlckdyb3VwID0gdGhpcy5jcmVhdGVBbnN3ZXJHcm91cChyYWRpb2JveCwgbGFiZWwpO1xuICAgICAgICAgICAgcXVlc3Rpb25Gb3JtLmFwcGVuZENoaWxkKGFuc3dlckdyb3VwKTtcbiAgICAgICAgICAgIHJhZGlvYm94SWQrKztcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgY3JlYXRlQW5zd2Vyc1N1bW1hcnkocXVlc3Rpb25zKSB7XG4gICAgICAgIHF1ZXN0aW9ucy5mb3JFYWNoKHF1ZXN0aW9uID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHNjb3JlU2VjdGlvblNjb3JlID0gdGhpcy5jcmVhdGVTY29yZVNlY3Rpb24oXCJTY29yZTpcIiwgcXVlc3Rpb24uYW5zd2VyRGV0YWlscy5zY29yZSk7XG4gICAgICAgICAgICBjb25zdCBhbnN3ZXJUaW1lID0gcXVlc3Rpb24uYW5zd2VyRGV0YWlscy5hbnN3ZXJUaW1lO1xuICAgICAgICAgICAgY29uc3Qgc2NvcmVTZWN0aW9uVGltZSA9IHRoaXMuY3JlYXRlU2NvcmVTZWN0aW9uKFwiVGltZTpcIiwgYCR7TWF0aC5mbG9vcihhbnN3ZXJUaW1lLzEwMDApfXNgKTtcbiAgICAgICAgICAgIGNvbnN0IHN1bW1hcnlJbmZvID0gdGhpcy5jcmVhdGVTdW1tYXJ5SW5mbyhzY29yZVNlY3Rpb25TY29yZSwgc2NvcmVTZWN0aW9uVGltZSk7XG4gICAgICAgICAgICBjb25zdCBhbnN3ZXJEZXRhaWxzID0gdGhpcy5jcmVhdGVBbnN3ZXJEZXRhaWxzKHN1bW1hcnlJbmZvLCBxdWVzdGlvbik7XG4gICAgICAgICAgICBzdW1tYXJ5QW5zd2Vyc0Rpdi5hcHBlbmRDaGlsZChhbnN3ZXJEZXRhaWxzKTtcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgIH1cblxuICAgIGNyZWF0ZUFuc3dlckRldGFpbHMoc3VtbWFyeUluZm8sIHF1ZXN0aW9uKSB7XG4gICAgICAgIGNvbnN0IGFuc3dlckRldGFpbHMgPSB0aGlzLmdldERpdihcInN1bW1hcnlEaXZcIiwgXCJcIik7XG4gICAgICAgIGFuc3dlckRldGFpbHMuYXBwZW5kQ2hpbGQodGhpcy5nZXREaXYoXCJxdWVzdGlvblwiLCBxdWVzdGlvbi5xdWVzdGlvbikpO1xuICAgICAgICBhbnN3ZXJEZXRhaWxzLmFwcGVuZENoaWxkKHRoaXMuZ2V0SHIoKSk7XG4gICAgICAgIGFuc3dlckRldGFpbHMuYXBwZW5kQ2hpbGQodGhpcy5nZXREaXYoXCJxdWVzdGlvblwiLCBcIllvdXIgYW5zd2VyOiBcIiArIHF1ZXN0aW9uLmFuc3dlckRldGFpbHMuYW5zd2VyKSk7XG4gICAgICAgIGFuc3dlckRldGFpbHMuYXBwZW5kQ2hpbGQodGhpcy5nZXRIcigpKTtcbiAgICAgICAgYW5zd2VyRGV0YWlscy5hcHBlbmRDaGlsZCh0aGlzLmdldERpdihcInF1ZXN0aW9uXCIsIFwiQ29ycmVjdCBhbnN3ZXI6IFwiICsgcXVlc3Rpb24uY29ycmVjdEFuc3dlcikpO1xuICAgICAgICBhbnN3ZXJEZXRhaWxzLmFwcGVuZENoaWxkKHRoaXMuZ2V0SHIoKSk7XG4gICAgICAgIGFuc3dlckRldGFpbHMuYXBwZW5kQ2hpbGQoc3VtbWFyeUluZm8pO1xuICAgICAgICByZXR1cm4gYW5zd2VyRGV0YWlscztcbiAgICB9XG5cbiAgICBjcmVhdGVTdW1tYXJ5SW5mbyhzZWN0aW9uU2NvcmUsIHNlY3Rpb25UaW1lKSB7XG4gICAgICAgIGNvbnN0IHN1bW1hcnlJbmZvID0gdGhpcy5nZXREaXYoXCJzdW1tYXJ5SW5mb0RpdlwiLCBcIlwiKTtcbiAgICAgICAgc3VtbWFyeUluZm8uYXBwZW5kQ2hpbGQoc2VjdGlvblNjb3JlKTtcbiAgICAgICAgc3VtbWFyeUluZm8uYXBwZW5kQ2hpbGQoc2VjdGlvblRpbWUpO1xuICAgICAgICByZXR1cm4gc3VtbWFyeUluZm87XG4gICAgfVxuXG4gICAgY3JlYXRlU2NvcmVTZWN0aW9uKGxhYmVsTmFtZSwgdmFsdWUpIHtcbiAgICAgICAgY29uc3QgbGFiZWwgPSB0aGlzLmdldExhYmVsKGxhYmVsTmFtZSk7XG4gICAgICAgIGNvbnN0IHZhbHVlRGl2ID0gdGhpcy5nZXREaXYoXCJhbnN3ZXJTY29yZVwiLCB2YWx1ZSk7XG4gICAgICAgIGNvbnN0IHNjb3JlU2VjdGlvbiA9IHRoaXMuZ2V0RGl2KFwic2NvcmVTZWN0aW9uXCIsIFwiXCIpO1xuICAgICAgICBzY29yZVNlY3Rpb24uYXBwZW5kQ2hpbGQobGFiZWwpO1xuICAgICAgICBzY29yZVNlY3Rpb24uYXBwZW5kQ2hpbGQodmFsdWVEaXYpO1xuICAgICAgICByZXR1cm4gc2NvcmVTZWN0aW9uO1xuICAgIH1cblxuICAgIGdldEhyKCkge1xuICAgICAgICByZXR1cm4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImhyXCIpO1xuICAgIH1cblxuICAgIGdldERpdihjbGFzc05hbWUsIGlubmVySFRNTCkge1xuICAgICAgICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICBkaXYuY2xhc3NMaXN0LmFkZChjbGFzc05hbWUpO1xuICAgICAgICBkaXYuaW5uZXJIVE1MID0gaW5uZXJIVE1MO1xuICAgICAgICByZXR1cm4gZGl2O1xuICAgIH1cblxuICAgIGdldExhYmVsKGlubmVySFRNTCkge1xuICAgICAgICBjb25zdCBsYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsYWJlbFwiKTtcbiAgICAgICAgbGFiZWwuaW5uZXJIVE1MID0gaW5uZXJIVE1MO1xuICAgICAgICByZXR1cm4gbGFiZWw7XG4gICAgfVxufSIsImltcG9ydCBDYXRlZ29yaWVzRmV0Y2hlciBmcm9tIFwiLi4vc2VydmljZS9jYXRlZ29yaWVzRmV0Y2hlclwiO1xuaW1wb3J0IEVsZW1lbnRzQ3JlYXRvciBmcm9tIFwiLi9lbGVtZW50c0NyZWF0b3JcIjtcblxuY29uc3QgY2F0ZWdvcmllcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2F0ZWdvcnlcIik7XG5jb25zdCBxdWVzdGlvbnNOdW0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInF1YW50aXR5XCIpO1xuY29uc3QgcHJvcGVydGllcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJvcGVydGllc1wiKTtcbmNvbnN0IHByb2dyZXNzQmFyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwcm9ncmVzc0JhclwiKTtcbmNvbnN0IHF1ZXN0aW9uc0RpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicXVlc3Rpb25zXCIpO1xuY29uc3QgcXVlc3Rpb25EaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInF1ZXN0aW9uXCIpO1xuY29uc3Qgc3VtbWFyeURpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic3VtbWFyeVwiKTtcbmNvbnN0IHN1bW1hcnlBbnN3ZXJzRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhbnN3ZXJzU3VtbWFyeVwiKTtcbmNvbnN0IHF1ZXN0aW9uRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wicXVlc3Rpb25Gb3JtXCJdO1xuY29uc3QgdGltZXJEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRpbWVyXCIpO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW50ZXJmYWNlIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5jYXRlZ29yaWVzRmV0Y2hlciA9IG5ldyBDYXRlZ29yaWVzRmV0Y2hlcigpO1xuICAgICAgICB0aGlzLmVsZW1lbnRzQ3JlYXRvciA9IG5ldyBFbGVtZW50c0NyZWF0b3IoKTtcbiAgICAgICAgdGhpcy50aW1lclNlYyA9IDE7XG4gICAgfVxuXG4gICAgYXN5bmMgcG9wdWxhdGVDYXRlZ29yaWVzKCkge1xuICAgICAgICBhd2FpdCB0aGlzLmNhdGVnb3JpZXNGZXRjaGVyLmZldGNoQ2F0ZWdvcmllcygpXG4gICAgICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7cmVzcG9uc2UuZm9yRWFjaChvYmogPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IG9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJvcHRpb25cIik7XG4gICAgICAgICAgICAgICAgb3B0aW9uLnRleHQgPSBvYmoubmFtZTtcbiAgICAgICAgICAgICAgICBvcHRpb24udmFsdWUgPSBvYmouaWQ7XG4gICAgICAgICAgICAgICAgY2F0ZWdvcmllcy5hZGQob3B0aW9uKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwb3B1bGF0ZVF1ZXN0aW9uTnVtcygpIHtcbiAgICAgICAgZm9yKGxldCBpPTU7IGk8MjY7IGkrKykge1xuICAgICAgICAgICAgY29uc3Qgb3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIm9wdGlvblwiKTtcbiAgICAgICAgICAgIG9wdGlvbi50ZXh0ID0gaTtcbiAgICAgICAgICAgIG9wdGlvbi52YWx1ZSA9IGk7XG4gICAgICAgICAgICBpZihpPT0xMCkgb3B0aW9uLnNlbGVjdGVkID1cInNlbGVjdGVkXCI7XG4gICAgICAgICAgICBxdWVzdGlvbnNOdW0uYWRkKG9wdGlvbik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcmVwYXJlUHJvcGVydGllc1NjcmVlbigpIHtcbiAgICAgICAgcHJvcGVydGllcy5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZVwiKTtcbiAgICAgICAgc3VtbWFyeURpdi5jbGFzc0xpc3QuYWRkKFwiaGlkZVwiKTtcbiAgICAgICAgc3VtbWFyeUFuc3dlcnNEaXYuY2xhc3NMaXN0LmFkZChcImhpZGVcIik7XG4gICAgICAgIHN1bW1hcnlBbnN3ZXJzRGl2LmlubmVySFRNTCA9IFwiXCI7XG4gICAgfVxuXG4gICAgcHJlcGFyZVF1ZXN0aW9uU2NyZWVuKCkge1xuICAgICAgICBwcm9wZXJ0aWVzLmNsYXNzTGlzdC5hZGQoXCJoaWRlXCIpO1xuICAgICAgICBwcm9ncmVzc0Jhci5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZVwiKTtcbiAgICAgICAgcXVlc3Rpb25zLmNsYXNzTGlzdC5yZW1vdmUoXCJoaWRlXCIpO1xuICAgIH1cblxuICAgIHByZXBhcmVRdWVzdGlvbnNTY3JlZW5XaGVuUmVwbGF5KCkge1xuICAgICAgICBzdW1tYXJ5RGl2LmNsYXNzTGlzdC5hZGQoXCJoaWRlXCIpO1xuICAgICAgICBzdW1tYXJ5QW5zd2Vyc0Rpdi5jbGFzc0xpc3QuYWRkKFwiaGlkZVwiKTtcbiAgICAgICAgc3VtbWFyeUFuc3dlcnNEaXYuaW5uZXJIVE1MID0gXCJcIjtcbiAgICB9XG5cbiAgICBwcmVwYXJlU3VtbWFyeVNjcmVlbihxdWVzdGlvbnMsIGdhbWVEZXRhaWxzKSB7XG4gICAgICAgIHByb2dyZXNzQmFyLmNsYXNzTGlzdC5hZGQoXCJoaWRlXCIpO1xuICAgICAgICBxdWVzdGlvbnNEaXYuY2xhc3NMaXN0LmFkZChcImhpZGVcIik7XG4gICAgICAgIHN1bW1hcnlEaXYuY2xhc3NMaXN0LnJlbW92ZShcImhpZGVcIik7XG4gICAgICAgIHN1bW1hcnlBbnN3ZXJzRGl2LmNsYXNzTGlzdC5yZW1vdmUoXCJoaWRlXCIpO1xuICAgICAgICB0aGlzLmVsZW1lbnRzQ3JlYXRvci5jcmVhdGVBbnN3ZXJzU3VtbWFyeShxdWVzdGlvbnMpO1xuICAgICAgICB0aGlzLmRpc3BsYXlHYW1lRGV0YWlscyhnYW1lRGV0YWlscyk7XG4gICAgfVxuXG4gICAgc2hvd1F1ZXN0aW9uKHF1ZXN0aW9uLCBxdWVzdGlvbk51bSwgY3VycmVudFF1ZXN0aW9uTnVtKSB7XG4gICAgICAgIHF1ZXN0aW9uRGl2LmlubmVySFRNTCA9IHF1ZXN0aW9uLnF1ZXN0aW9uO1xuICAgICAgICBjb25zdCBhbGxBbnN3ZXJzID0gdGhpcy5nZXRBbGxBbnN3ZXJzKHF1ZXN0aW9uKTtcbiAgICAgICAgcXVlc3Rpb25Gb3JtLmlubmVySFRNTCA9IFwiXCI7XG4gICAgICAgIHRoaXMuZWxlbWVudHNDcmVhdG9yLmNyZWF0ZUFuc3dlcnMoYWxsQW5zd2Vycyk7XG4gICAgICAgIHRoaXMuaW5jcmVzZVByb2dyZXNzQmFyKHF1ZXN0aW9uTnVtLCBjdXJyZW50UXVlc3Rpb25OdW0pXG4gICAgfVxuXG4gICAgaW5jcmVzZVByb2dyZXNzQmFyKHF1ZXN0aW9uTnVtLCBjdXJyZW50UXVlc3Rpb25OdW0pIHtcbiAgICAgICAgY29uc3QgcHJvZ3Jlc3NWYWx1ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJvZ3Jlc3NWYWx1ZVwiKTtcbiAgICAgICAgY29uc3QgY2FsY3VsYXRlZFdpZHRoID0gKGN1cnJlbnRRdWVzdGlvbk51bSAvIHF1ZXN0aW9uTnVtKSAqIDEwMDtcbiAgICAgICAgY29uc3Qgd2lkdGhWYWx1ZSA9IGNhbGN1bGF0ZWRXaWR0aCArIFwiJVwiO1xuICAgICAgICBwcm9ncmVzc1ZhbHVlLnN0eWxlLndpZHRoID0gd2lkdGhWYWx1ZTtcbiAgICB9XG5cbiAgICBzaHVmZmxlQXJyYXkoYXJyYXkpIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IGFycmF5Lmxlbmd0aCAtIDE7IGkgPiAwOyBpLS0pIHtcbiAgICAgICAgICAgIGxldCBqID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKGkgKyAxKSk7XG4gICAgICAgICAgICBsZXQgdGVtcCA9IGFycmF5W2ldO1xuICAgICAgICAgICAgYXJyYXlbaV0gPSBhcnJheVtqXTtcbiAgICAgICAgICAgIGFycmF5W2pdID0gdGVtcDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldEFsbEFuc3dlcnMocXVlc3Rpb24pIHtcbiAgICAgICAgY29uc3QgYWxsQW5zd2VycyA9IHF1ZXN0aW9uLmluY29ycmVjdEFuc3dlcnM7XG4gICAgICAgIGFsbEFuc3dlcnMucHVzaChxdWVzdGlvbi5jb3JyZWN0QW5zd2VyKTtcbiAgICAgICAgdGhpcy5zaHVmZmxlQXJyYXkoYWxsQW5zd2Vycyk7XG4gICAgICAgIHJldHVybiBhbGxBbnN3ZXJzO1xuICAgIH1cblxuICAgIGdldFNlbGVjdGVkUmFkaW9WYWx1ZSgpIHtcbiAgICAgICAgbGV0IHNlbGVjdGVkQW5zd2VyID0gXCJcIjtcbiAgICAgICAgcXVlc3Rpb25Gb3JtW1wiYW5zd2VyXCJdLmZvckVhY2goYW5zd2VyID0+IHtcbiAgICAgICAgICAgIGlmKGFuc3dlci5jaGVja2VkKSBzZWxlY3RlZEFuc3dlciA9IGFuc3dlci52YWx1ZTtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmKHNlbGVjdGVkQW5zd2VyID09PSBcIlwiKSBhbGVydChcIlBsZWFzZSBzZWxlY3QgYW4gYW5zd2VyIG9yIHNraXAgdGhlIHF1ZXN0aW9uLlwiKVxuICAgICAgICByZXR1cm4gc2VsZWN0ZWRBbnN3ZXI7XG4gICAgfVxuXG4gICAgZGlzcGxheUdhbWVEZXRhaWxzKGdhbWVEZXRhaWxzKSB7XG4gICAgICAgIGNvbnN0IHRvdGFsU2NvcmUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRvdGFsU2NvcmVcIik7XG4gICAgICAgIGNvbnN0IHRvdGFsVGltZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidG90YWxUaW1lXCIpO1xuICAgICAgICBjb25zdCB0aW1lSW5NaWxpcyA9IGdhbWVEZXRhaWxzLnRvdGFsVGltZXIuZ2V0TWlsaXNlY29uZHNGcm9tU3RhcnQoKTtcbiAgICAgICAgY29uc3QgdGltZUluc1NlYyA9IE1hdGguZmxvb3IodGltZUluTWlsaXMvMTAwMCk7XG4gICAgICAgIHRvdGFsU2NvcmUuaW5uZXJIVE1MID0gZ2FtZURldGFpbHMudG90YWxTY29yZTtcbiAgICAgICAgdG90YWxUaW1lLmlubmVySFRNTCA9IGAke01hdGguZmxvb3IodGltZUluc1NlYy82MCl9OiR7dGltZUluc1NlYyU2MH1gO1xuICAgIH1cblxuICAgIHN0YXJ0UXVlc3Rpb25UaW1lcigpIHtcbiAgICAgICAgY29uc3QgbWludXRlcyA9IE1hdGguZmxvb3IodGhpcy50aW1lclNlYy82MCk7XG4gICAgICAgIHRpbWVyRGl2LmlubmVySFRNTCA9IG1pbnV0ZXMgKyBcIjpcIiArIHRoaXMudGltZXJTZWMlNjA7XG4gICAgICAgIHRoaXMudGltZXJTZWMgKys7XG4gICAgfVxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFRpbWVyIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5zdGFydCA9IG5ldyBEYXRlKCk7XG4gICAgfVxuXG4gICAgZ2V0TWlsaXNlY29uZHNGcm9tU3RhcnQoKSB7XG4gICAgICAgIGxldCBzdG9wID0gbmV3IERhdGUoKTtcbiAgICAgICAgcmV0dXJuIHN0b3AuZ2V0VGltZSgpIC0gdGhpcy5zdGFydC5nZXRUaW1lKCk7XG4gICAgfVxufSIsImltcG9ydCBUaW1lciBmcm9tIFwiLi4vZ2FtZS90aW1lclwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHYW1lRGV0YWlscyB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMudG90YWxUaW1lciA9IG5ldyBUaW1lcigpO1xuICAgICAgICB0aGlzLnRvdGFsU2NvcmUgPSAwO1xuICAgIH1cbn0iLCJpbXBvcnQgQW5zd2VyRGV0YWlscyBmcm9tIFwiLi4vbW9kZWwvYW5zd2VyRGV0YWlsc1wiXG5pbXBvcnQgUXVlc3Rpb25zRmV0Y2hlciBmcm9tIFwiLi4vc2VydmljZS9xdWVzdGlvbnNGZXRjaGVyXCI7XG5pbXBvcnQgUXVlc3Rpb24gZnJvbSBcIi4uL21vZGVsL3F1ZXN0aW9uXCI7XG5pbXBvcnQgVXNlckludGVyZmFjZSBmcm9tIFwiLi4vdWkvdXNlckludGVyZmFjZVwiO1xuaW1wb3J0IFRpbWVyIGZyb20gXCIuL3RpbWVyXCI7XG5pbXBvcnQgR2FtZURldGFpbHMgZnJvbSBcIi4uL21vZGVsL2dhbWVEZXRhaWxzXCI7XG5cbmNvbnN0IHByb3BlcnRpZXNGb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJwcm9wZXJ0aWVzRm9ybVwiXTtcbmNvbnN0IGJvbnVzVGltZSA9IDUwMDA7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEdhbWUge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLnF1ZXN0aW9ucyA9IFtdO1xuICAgICAgICB0aGlzLmN1cnJlbnRRdWVzdGlvbk51bSA9IC0xO1xuICAgICAgICB0aGlzLnVzZXJJbnRlcmZhY2UgPSBuZXcgVXNlckludGVyZmFjZSgpO1xuICAgICAgICB0aGlzLnF1ZXN0aW9uRmV0Y2hlciA9IG5ldyBRdWVzdGlvbnNGZXRjaGVyKCk7XG4gICAgICAgIHRoaXMucXVlc3Rpb25UaW1lciA9IHt9O1xuICAgICAgICB0aGlzLmdhbWVEZXRhaWxzID0ge307XG4gICAgfVxuXG4gICAgc3RhcnRHYW1lKCkge1xuICAgICAgICB0aGlzLnVzZXJJbnRlcmZhY2UucG9wdWxhdGVDYXRlZ29yaWVzKCk7XG4gICAgICAgIHRoaXMudXNlckludGVyZmFjZS5wb3B1bGF0ZVF1ZXN0aW9uTnVtcygpO1xuICAgIH1cblxuICAgIHBsYXlBZ2FpbigpIHtcbiAgICAgICAgdGhpcy5wcmVwYXJlVG9OZXdHYW1lKCk7XG4gICAgICAgIHRoaXMuc3VibWl0UHJvcGVydGllcygpO1xuICAgICAgICB0aGlzLnVzZXJJbnRlcmZhY2UucHJlcGFyZVF1ZXN0aW9uc1NjcmVlbldoZW5SZXBsYXkoKTtcbiAgICB9XG5cbiAgICBzdGFydE5ld0dhbWUoKSB7XG4gICAgICAgIHRoaXMucHJlcGFyZVRvTmV3R2FtZSgpO1xuICAgICAgICB0aGlzLnVzZXJJbnRlcmZhY2UucHJlcGFyZVByb3BlcnRpZXNTY3JlZW4oKTtcbiAgICB9XG5cbiAgICBwcmVwYXJlVG9OZXdHYW1lKCkge1xuICAgICAgICB0aGlzLnF1ZXN0aW9ucyA9IFtdO1xuICAgICAgICB0aGlzLmN1cnJlbnRRdWVzdGlvbk51bSA9IC0xO1xuICAgIH1cbiAgICAgICAgXG4gICAgYXN5bmMgc3VibWl0UHJvcGVydGllcygpIHtcbiAgICAgICAgdGhpcy5nYW1lRGV0YWlscyA9IG5ldyBHYW1lRGV0YWlscygpO1xuICAgICAgICBjb25zdCBxdWVzdGlvbnNOdW0gPSBwcm9wZXJ0aWVzRm9ybVtcInF1YW50aXR5XCJdLnZhbHVlO1xuICAgICAgICBjb25zdCBjYXRlZ29yeSA9IHByb3BlcnRpZXNGb3JtW1wiY2F0ZWdvcnlcIl0udmFsdWU7XG4gICAgICAgIGNvbnN0IGRpZmZpY3VsdHkgPSBwcm9wZXJ0aWVzRm9ybVtcImRpZmZpY3VsdHlcIl0udmFsdWU7XG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZVF1ZXN0aW9ucyhxdWVzdGlvbnNOdW0sIGNhdGVnb3J5LCBkaWZmaWN1bHR5KTtcbiAgICAgICAgdGhpcy51c2VySW50ZXJmYWNlLnByZXBhcmVRdWVzdGlvblNjcmVlbigpO1xuICAgICAgICB0aGlzLmxvYWROZXh0UXVlc3Rpb24oKTtcbiAgICB9XG5cbiAgICBhc3luYyBzYXZlUXVlc3Rpb25zKHF1ZXN0aW9uc051bSwgY2F0ZWdvcnksIGRpZmZpY3VsdHkpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5xdWVzdGlvbkZldGNoZXIuZmV0Y2hRdWVzdGlvbnMocXVlc3Rpb25zTnVtLCBjYXRlZ29yeSwgZGlmZmljdWx0eSlcbiAgICAgICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHtcbiAgICAgICAgICAgICAgICByZXNwb25zZS5mb3JFYWNoKG9iaiA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucXVlc3Rpb25zLnB1c2gobmV3IFF1ZXN0aW9uKG9iaikpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGxvYWROZXh0UXVlc3Rpb24oKSB7XG4gICAgICAgIGlmKHRoaXMuY3VycmVudFF1ZXN0aW9uTnVtIDwgdGhpcy5xdWVzdGlvbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRRdWVzdGlvbk51bSArKztcbiAgICAgICAgICAgIHRoaXMudXNlckludGVyZmFjZS5zaG93UXVlc3Rpb24odGhpcy5xdWVzdGlvbnNbdGhpcy5jdXJyZW50UXVlc3Rpb25OdW1dLCB0aGlzLnF1ZXN0aW9ucy5sZW5ndGgsIHRoaXMuY3VycmVudFF1ZXN0aW9uTnVtKTtcbiAgICAgICAgICAgIHRoaXMuc3RhcnRUaW1lcigpO1xuICAgICAgICAgICAgdGhpcy5wcmVwYXJlVmlzaWJsZVRpbWVyKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcmVwYXJlVmlzaWJsZVRpbWVyKCkge1xuICAgICAgICB0aGlzLnVzZXJJbnRlcmZhY2UudGltZXJTZWMgPSAxO1xuICAgICAgICBjb25zdCB0aW1lckRpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidGltZXJcIik7XG4gICAgICAgIHRpbWVyRGl2LmlubmVySFRNTCA9IFwiMDowXCI7XG4gICAgfVxuXG4gICAgc3RhcnRUaW1lcigpIHtcbiAgICAgICAgdGhpcy5xdWVzdGlvblRpbWVyID0gbmV3IFRpbWVyKCk7XG4gICAgfVxuXG4gICAgc3RhcnRWaXNpYmxlVGltZXIoKSB7XG4gICAgICAgIHRoaXMudXNlckludGVyZmFjZS5zdGFydFF1ZXN0aW9uVGltZXIoKTtcbiAgICB9XG5cbiAgICBhbnN3ZXIoaXNBbnN3ZXJlZCkge1xuICAgICAgICBjb25zdCBhbnN3ZXIgPSB0aGlzLmdldEFuc3dlcihpc0Fuc3dlcmVkKTtcbiAgICAgICAgY29uc3QgaXNBbnN3ZXJOb3RDaGVja2VkID0gKGlzQW5zd2VyZWQgJiYgYW5zd2VyID09XCJcIik7XG4gICAgICAgIGlmKCFpc0Fuc3dlck5vdENoZWNrZWQpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0QW5zd2VyRGV0YWlscyhpc0Fuc3dlcmVkLCBhbnN3ZXIpO1xuICAgICAgICAgICAgdGhpcy5zZXRUb3RhbFNjb3JlKCk7XG4gICAgICAgICAgICB0aGlzLmxvYWROZXh0U2NyZWVuKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzZXRBbnN3ZXJEZXRhaWxzKGlzQW5zd2VyZWQsIGFuc3dlcikge1xuICAgICAgICBjb25zdCB0aW1lID0gdGhpcy5xdWVzdGlvblRpbWVyLmdldE1pbGlzZWNvbmRzRnJvbVN0YXJ0KCk7XG4gICAgICAgIGNvbnN0IGNvcnJlY3RBbnN3ZXIgPSB0aGlzLnF1ZXN0aW9uc1t0aGlzLmN1cnJlbnRRdWVzdGlvbk51bV0uY29ycmVjdEFuc3dlcjtcbiAgICAgICAgbGV0IHNjb3JlID0gdGhpcy5nZXRTY29yZShpc0Fuc3dlcmVkLCBhbnN3ZXIsIGNvcnJlY3RBbnN3ZXIsIHRpbWUpO1xuICAgICAgICBjb25zdCBhbnN3ZXJEZXRhaWxzID0gbmV3IEFuc3dlckRldGFpbHModGltZSwgaXNBbnN3ZXJlZCwgYW5zd2VyLCBzY29yZSk7XG4gICAgICAgIHRoaXMucXVlc3Rpb25zW3RoaXMuY3VycmVudFF1ZXN0aW9uTnVtXS5zZXRBbnN3ZXJEZXRhaWxzKGFuc3dlckRldGFpbHMpO1xuICAgIH1cblxuICAgIGdldEFuc3dlcihpc0Fuc3dlcmVkKSB7XG4gICAgICAgIGxldCBhbnN3ZXIgPSBcIlwiO1xuICAgICAgICBpZihpc0Fuc3dlcmVkKSBhbnN3ZXIgPSB0aGlzLnVzZXJJbnRlcmZhY2UuZ2V0U2VsZWN0ZWRSYWRpb1ZhbHVlKCk7XG4gICAgICAgIHJldHVybiBhbnN3ZXI7XG4gICAgfVxuXG4gICAgZ2V0U2NvcmUoaXNBbnN3ZXJlZCwgYW5zd2VyLCBjb3JyZWN0QW5zd2VyLCB0aW1lKSB7XG4gICAgICAgIGxldCBzY29yZSA9IDA7XG4gICAgICAgIGlmKGlzQW5zd2VyZWQpIHNjb3JlID0gdGhpcy5jYWxjdWxhdGVTY29yZShhbnN3ZXIsIGNvcnJlY3RBbnN3ZXIsIHRpbWUpO1xuICAgICAgICByZXR1cm4gc2NvcmU7XG4gICAgfVxuXG4gICAgc2V0VG90YWxTY29yZSgpIHtcbiAgICAgICAgY29uc3QgY3VycmVudFF1ZXN0aW9uID0gdGhpcy5xdWVzdGlvbnNbdGhpcy5jdXJyZW50UXVlc3Rpb25OdW1dO1xuICAgICAgICBjb25zdCBjdXJyZW50UXVlc3Rpb25TY29yZSA9IGN1cnJlbnRRdWVzdGlvbi5hbnN3ZXJEZXRhaWxzLnNjb3JlO1xuICAgICAgICB0aGlzLmdhbWVEZXRhaWxzLnRvdGFsU2NvcmUgKz0gY3VycmVudFF1ZXN0aW9uU2NvcmU7XG4gICAgfVxuXG4gICAgbG9hZE5leHRTY3JlZW4oKSB7XG4gICAgICAgIGNvbnN0IGxhc3RRdWVzdGlvbk51bSA9IHRoaXMucXVlc3Rpb25zLmxlbmd0aCAtIDE7XG4gICAgICAgIGlmKHRoaXMuY3VycmVudFF1ZXN0aW9uTnVtIDwgbGFzdFF1ZXN0aW9uTnVtKSB0aGlzLmxvYWROZXh0UXVlc3Rpb24oKTtcbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnVzZXJJbnRlcmZhY2UucHJlcGFyZVN1bW1hcnlTY3JlZW4odGhpcy5xdWVzdGlvbnMsIHRoaXMuZ2FtZURldGFpbHMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY2FsY3VsYXRlU2NvcmUoYW5zd2VyLCBjb3JyZWN0QW5zd2VyLCB0aW1lKSB7XG4gICAgICAgIGxldCBzY29yZSA9IDA7XG4gICAgICAgIGlmKGFuc3dlciA9PT0gY29ycmVjdEFuc3dlcikge1xuICAgICAgICAgICAgc2NvcmUgKz0gMTtcbiAgICAgICAgICAgIGlmKHRpbWUgPCBib251c1RpbWUpIHNjb3JlICs9IDAuNTtcbiAgICAgICAgfSBlbHNlIHNjb3JlIC09IDAuMjU7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gc2NvcmU7XG4gICAgfVxufSIsImltcG9ydCBHYW1lIGZyb20gXCIuL2dhbWUvZ2FtZVwiO1xuXG5jb25zdCBwbGF5QnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwbGF5QnV0dG9uXCIpO1xuY29uc3QgYW5zd2VyQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhbnN3ZXJCdXR0b25cIik7XG5jb25zdCBza2lwQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJza2lwQnV0dG9uXCIpO1xuY29uc3QgcGxheUFnYWluQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwbGF5QWdhaW5CdXR0b25cIik7XG5jb25zdCBuZXdHYW1lQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJuZXdHYW1lQnV0dG9uXCIpO1xuXG5mdW5jdGlvbiBzdGFydEdhbWUoKSB7XG4gICAgY29uc3QgZ2FtZSA9IG5ldyBHYW1lKCk7XG4gICAgZ2FtZS5zdGFydEdhbWUoKTtcbiAgICBwbGF5QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBnYW1lLnN1Ym1pdFByb3BlcnRpZXMoKSk7XG4gICAgYW5zd2VyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBnYW1lLmFuc3dlcih0cnVlKSk7XG4gICAgc2tpcEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gZ2FtZS5hbnN3ZXIoZmFsc2UpKTtcbiAgICBwbGF5QWdhaW5CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGdhbWUucGxheUFnYWluKCkpO1xuICAgIG5ld0dhbWVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGdhbWUuc3RhcnROZXdHYW1lKCkpO1xuICAgIGNvbnN0IHF1ZXN0aW9uVGltZXIgPSBzZXRJbnRlcnZhbCgoKSA9PiBnYW1lLnN0YXJ0VmlzaWJsZVRpbWVyKCksIDEwMDApO1xufVxuXG5zdGFydEdhbWUoKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///442\n')})();