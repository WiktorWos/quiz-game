(()=>{"use strict";eval('\n;// CONCATENATED MODULE: ./model/answerDetails.js\nclass AnswerDetails {\n    constructor(answerTime, isAnswered, answer, score) {\n        this.answerTime = answerTime;\n        this.isAnswered = isAnswered;\n        this.answer = answer;\n        this.score = score;\n    }\n}\n;// CONCATENATED MODULE: ./service/questionsFetcher.js\nclass QuestionsFetcher {\n    async fetchQuestions(questionsNum, category, difficulty) {\n        const apiURL = `https://opentdb.com/api.php?amount=${questionsNum}&category=${category}&difficulty=${difficulty}&type=multiple`;\n        return fetch(apiURL)\n            .then(response => response.json()) \n            .then(data=>{\n                return data.results;\n            })\n            .catch(error => alert(error));\n    }\n}\n;// CONCATENATED MODULE: ./model/question.js\nclass Question {\n    constructor(responseObj) {\n        this.category = responseObj.category;\n        this.type = responseObj.type;\n        this.difficulty = responseObj.difficulty;\n        this.question = responseObj.question;\n        this.correctAnswer = responseObj.correct_answer;\n        this.incorrectAnswers = responseObj.incorrect_answers;\n        this.answerDetails = {};\n    }\n\n    setAnswerDetails(answerDetails) {\n        this.answerDetails = answerDetails;\n    }\n}\n;// CONCATENATED MODULE: ./service/categoriesFetcher.js\nclass CategoriesFetcher {\n    async fetchCategories() {\n        const apiURL = "https://opentdb.com/api_category.php";\n        return fetch(apiURL)\n            .then(response => response.json()) \n            .then(data=>{\n                return data.trivia_categories;\n            })\n            .catch(error => alert(error));\n    }\n}\n;// CONCATENATED MODULE: ./ui/userInterface.js\n\n\nconst categories = document.getElementById("category");\nconst questionsNum = document.getElementById("quantity");\nconst properties = document.getElementById("properties");\nconst progressBar = document.getElementById("progressBar");\nconst questionsDiv = document.getElementById("questions");\nconst questionDiv = document.getElementById("question");\nconst summaryDiv = document.getElementById("summary");\nconst summaryAnswersDiv = document.getElementById("answersSummary");\nconst questionForm = document.forms["questionForm"];\nconst timerDiv = document.getElementById("timer");\n\nclass UserInterface {\n    constructor() {\n        this.categoriesFetcher = new CategoriesFetcher();\n        this.timerSec = 1;\n    }\n\n    async populateCategories() {\n        await this.categoriesFetcher.fetchCategories()\n            .then(response => {response.forEach(obj => {\n                let option = document.createElement("option");\n                option.text = obj.name;\n                option.value = obj.id;\n                categories.add(option);\n            });\n        });\n    }\n\n    async populateQuestionNums() {\n        for(let i=5; i<26; i++) {\n            let option = document.createElement("option");\n            option.text = i;\n            option.value = i;\n            questionsNum.add(option);\n        }\n    }\n\n    async preparePropertiesScreen() {\n        properties.classList.remove("hide");\n        summaryDiv.classList.add("hide");\n        summaryAnswersDiv.classList.add("hide");\n        summaryAnswersDiv.innerHTML = "";\n    }\n\n    async prepareQuestionScreen() {\n        properties.classList.add("hide");\n        progressBar.classList.remove("hide");\n        questions.classList.remove("hide");\n    }\n\n    async prepareQuestionsScreenWhenReplay() {\n        summaryDiv.classList.add("hide");\n        summaryAnswersDiv.classList.add("hide");\n        summaryAnswersDiv.innerHTML = "";\n    }\n\n    async prepareSummaryScreen(questions, gameDetails) {\n        progressBar.classList.add("hide");\n        questionsDiv.classList.add("hide");\n        summaryDiv.classList.remove("hide");\n        summaryAnswersDiv.classList.remove("hide");\n        this.createAnswersSummary(questions);\n        this.displayGameDetails(gameDetails);\n    }\n\n    async showQuestion(question, questionNum, currentQuestionNum) {\n        questionDiv.innerHTML = question.question;\n        let allAnswers = this.getAllAnswers(question);\n        questionForm.innerHTML = "";\n        this.createAnswers(allAnswers);\n        this.increseProgressBar(questionNum, currentQuestionNum)\n    }\n\n    increseProgressBar(questionNum, currentQuestionNum) {\n        const progressValue = document.getElementById("progressValue");\n        const calculatedWidth = (currentQuestionNum / questionNum) * 100;\n        const widthValue = calculatedWidth + "%";\n        progressValue.style.width = widthValue;\n    }\n\n    shuffleArray(array) {\n        for (let i = array.length - 1; i > 0; i--) {\n            let j = Math.floor(Math.random() * (i + 1));\n            let temp = array[i];\n            array[i] = array[j];\n            array[j] = temp;\n        }\n    }\n\n    createRadioBox(answer, id) {\n        let radiobox = document.createElement(\'input\');\n        radiobox.id = id;\n        radiobox.type = \'radio\';\n        radiobox.value = answer;\n        radiobox.name = "answer"\n        return radiobox;\n    }\n\n    createLabel(answer, id) {\n        const label = document.createElement(\'label\')\n        label.htmlFor = id;\n        const description = document.createTextNode(answer);\n        label.appendChild(description);\n        return label;\n    }\n\n    createAnswerGroup(radiobox, label) {\n        const answerGroup = document.createElement("div");\n        answerGroup.classList.add("answerGroup");\n        \n        answerGroup.appendChild(radiobox);\n        answerGroup.appendChild(label);\n        return answerGroup;\n    }\n\n    getAllAnswers(question) {\n        const allAnswers = question.incorrectAnswers;\n        allAnswers.push(question.correctAnswer);\n        this.shuffleArray(allAnswers);\n        return allAnswers;\n    }\n\n    createAnswers(allAnswers) {\n        let radioboxId = 0;\n        allAnswers.forEach(answer => {\n            const radiobox = this.createRadioBox(answer, radioboxId);\n            const label = this.createLabel(answer, radioboxId);\n            const answerGroup = this.createAnswerGroup(radiobox, label);\n            questionForm.appendChild(answerGroup);\n            radioboxId++;\n        });\n    }\n\n    getSelectedRadioValue() {\n        let selectedAnswer = "";\n        questionForm["answer"].forEach(answer => {\n            if(answer.checked) selectedAnswer = answer.value;\n        });\n        if(selectedAnswer === "") alert("Please select an answer or skip the question.")\n        return selectedAnswer;\n    }\n\n    displayGameDetails(gameDetails) {\n        const totalScore = document.getElementById("totalScore");\n        const totalTime = document.getElementById("totalTime");\n        const timeInMilis = gameDetails.totalTimer.getMilisecondsFromStart();\n        const timeInsSec = Math.floor(timeInMilis/1000);\n        totalScore.innerHTML = gameDetails.totalScore;\n        totalTime.innerHTML = `${Math.floor(timeInsSec/60)}:${timeInsSec%60}`;\n    }\n\n    createAnswersSummary(questions) {\n        questions.forEach(question => {\n            const scoreSectionScore = this.createScoreSection("Score:", question.answerDetails.score);\n            const answerTime = question.answerDetails.answerTime;\n            const scoreSectionTime = this.createScoreSection("Time:", `${Math.floor(answerTime/1000)}s`);\n            const summaryInfo = this.createSummaryInfo(scoreSectionScore, scoreSectionTime);\n            const answerDetails = this.createAnswerDetails(summaryInfo, question);\n            summaryAnswersDiv.appendChild(answerDetails);\n        });\n        \n    }\n\n    createAnswerDetails(summaryInfo, question) {\n        const answerDetails = this.getDiv("summaryDiv", "");\n        answerDetails.appendChild(this.getDiv("question", question.question));\n        answerDetails.appendChild(this.getHr());\n        answerDetails.appendChild(this.getDiv("question", "Your answer: " + question.answerDetails.answer));\n        answerDetails.appendChild(this.getHr());\n        answerDetails.appendChild(this.getDiv("question", "Correct answer: " + question.correctAnswer));\n        answerDetails.appendChild(this.getHr());\n        answerDetails.appendChild(summaryInfo);\n        return answerDetails;\n    }\n\n    createSummaryInfo(sectionScore, sectionTime) {\n        const summaryInfo = this.getDiv("summaryInfoDiv", "");\n        summaryInfo.appendChild(sectionScore);\n        summaryInfo.appendChild(sectionTime);\n        return summaryInfo;\n    }\n\n    createScoreSection(labelName, value) {\n        const label = this.getLabel(labelName);\n        const valueDiv = this.getDiv("answerScore", value);\n        const scoreSection = this.getDiv("scoreSection", "");\n        scoreSection.appendChild(label);\n        scoreSection.appendChild(valueDiv);\n        return scoreSection;\n    }\n\n    getHr() {\n        return document.createElement("hr");\n    }\n\n    getDiv(className, innerHTML) {\n        const div = document.createElement("div");\n        div.classList.add(className);\n        div.innerHTML = innerHTML;\n        return div;\n    }\n\n    getLabel(innerHTML) {\n        const label = document.createElement("label");\n        label.innerHTML = innerHTML;\n        return label;\n    }\n\n    startQuestionTimer() {\n        const minutes = Math.floor(this.timerSec/60);\n        timerDiv.innerHTML = minutes + ":" + this.timerSec%60;\n        this.timerSec ++;\n    }\n}\n;// CONCATENATED MODULE: ./game/timer.js\nclass Timer {\n    constructor() {\n        this.start = new Date();\n    }\n\n    getMilisecondsFromStart() {\n        let stop = new Date();\n        return stop.getTime() - this.start.getTime();\n    }\n}\n;// CONCATENATED MODULE: ./model/gameDetails.js\n\n\nclass GameDetails {\n    constructor() {\n        this.totalTimer = new Timer();\n        this.totalScore = 0;\n    }\n}\n;// CONCATENATED MODULE: ./game/game.js\n\n\n\n\n\n\n\nconst propertiesForm = document.forms["propertiesForm"];\nconst bonusTime = 5000;\n\nclass Game {\n    constructor() {\n        this.questions = [];\n        this.currentQuestionNum = -1;\n        this.userInterface = new UserInterface();\n        this.questionFetcher = new QuestionsFetcher();\n        this.questionTimer = {};\n        this.gameDetails = {};\n    }\n\n    async startGame() {\n        this.userInterface.populateCategories();\n        this.userInterface.populateQuestionNums();\n    }\n\n    async playAgain() {\n        this.prepareToNewGame();\n        this.submitProperties();\n        this.userInterface.prepareQuestionsScreenWhenReplay();\n    }\n\n    async startNewGame() {\n        this.prepareToNewGame();\n        this.userInterface.preparePropertiesScreen();\n    }\n\n    prepareToNewGame() {\n        this.questions = [];\n        this.currentQuestionNum = -1;\n    }\n        \n    async submitProperties() {\n        this.gameDetails = new GameDetails();\n        const questionsNum = propertiesForm["quantity"].value;\n        const category = propertiesForm["category"].value;\n        const difficulty = propertiesForm["difficulty"].value;\n        await this.saveQuestions(questionsNum, category, difficulty);\n        this.userInterface.prepareQuestionScreen();\n        this.loadNextQuestion();\n    }\n\n    async saveQuestions(questionsNum, category, difficulty) {\n        await this.questionFetcher.fetchQuestions(questionsNum, category, difficulty)\n            .then(response => {\n                response.forEach(obj => {\n                    this.questions.push(new Question(obj));\n            });\n        });\n    }\n\n    loadNextQuestion() {\n        if(this.currentQuestionNum < this.questions.length) {\n            this.currentQuestionNum ++;\n            this.userInterface.showQuestion(this.questions[this.currentQuestionNum], this.questions.length, this.currentQuestionNum);\n            this.startTimer();\n            this.prepareVisibleTimer();\n        }\n    }\n\n    prepareVisibleTimer() {\n        this.userInterface.timerSec = 1;\n        const timerDiv = document.getElementById("timer");\n        timerDiv.innerHTML = "0:0";\n    }\n\n    startTimer() {\n        this.questionTimer = new Timer();\n        return timer;\n    }\n\n    startVisibleTimer() {\n        this.userInterface.startQuestionTimer();\n    }\n\n    answer(isAnswered) {\n        const answer = this.getAnswer(isAnswered);\n        const isAnswerNotChecked = (isAnswered && answer =="");\n        if(!isAnswerNotChecked) {\n            this.setAnswerDetails(isAnswered, answer);\n            this.setTotalScore();\n            this.loadNextScreen();\n        }\n    }\n\n    setAnswerDetails(isAnswered, answer) {\n        const time = this.questionTimer.getMilisecondsFromStart();\n        const correctAnswer = this.questions[this.currentQuestionNum].correctAnswer;\n        let score = this.getScore(isAnswered, answer, correctAnswer, time);\n        const answerDetails = new AnswerDetails(time, isAnswered, answer, score);\n        this.questions[this.currentQuestionNum].setAnswerDetails(answerDetails);\n    }\n\n    getAnswer(isAnswered) {\n        let answer = "";\n        if(isAnswered) answer = this.userInterface.getSelectedRadioValue();\n        return answer;\n    }\n\n    getScore(isAnswered, answer, correctAnswer, time) {\n        let score = 0;\n        if(isAnswered) score = this.calculateScore(answer, correctAnswer, time);\n        return score;\n    }\n\n    setTotalScore() {\n        const currentQuestion = this.questions[this.currentQuestionNum];\n        const currentQuestionScore = currentQuestion.answerDetails.score;\n        this.gameDetails.totalScore += currentQuestionScore;\n    }\n\n    loadNextScreen() {\n        const lastQuestionNum = this.questions.length - 1;\n        if(this.currentQuestionNum < lastQuestionNum) this.loadNextQuestion();\n        else {\n            this.userInterface.prepareSummaryScreen(this.questions, this.gameDetails);\n        }\n    }\n\n    calculateScore(answer, correctAnswer, time) {\n        let score = 0;\n        if(answer === correctAnswer) {\n            score += 1;\n            if(time < bonusTime) score += 0.5;\n        } else score -= 0.25;\n        \n        return score;\n    }\n}\n;// CONCATENATED MODULE: ./quizGame.js\n\n\nconst playButton = document.getElementById("playButton");\nconst answerButton = document.getElementById("answerButton");\nconst skipButton = document.getElementById("skipButton");\nconst playAgainButton = document.getElementById("playAgainButton");\nconst newGameButton = document.getElementById("newGameButton");\nconst quizGame_timerDiv = document.getElementById("timer");\n\nfunction startGame() {\n    const game = new Game();\n    game.startGame();\n    playButton.addEventListener("click", () => game.submitProperties());\n    answerButton.addEventListener("click", () => game.answer(true));\n    skipButton.addEventListener("click", () => game.answer(false));\n    playAgainButton.addEventListener("click", () => game.playAgain());\n    newGameButton.addEventListener("click", () => game.startNewGame());\n    const questionTimer = setInterval(() => game.startVisibleTimer(), 1000);\n}\n\nstartGame();\n\n\n\n// var questionTimer = setInterval(timer, 1000);\n// var sec = 0;\n// function timer() {\n//     let minutes = Math.floor(sec/60);\n//     timerDiv.innerHTML = minutes + ":" + sec%60;\n//     sec ++;\n// }//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9xdWl6Z2FtZS8uL21vZGVsL2Fuc3dlckRldGFpbHMuanM/NjU1NiIsIndlYnBhY2s6Ly9xdWl6Z2FtZS8uL3NlcnZpY2UvcXVlc3Rpb25zRmV0Y2hlci5qcz83NDk1Iiwid2VicGFjazovL3F1aXpnYW1lLy4vbW9kZWwvcXVlc3Rpb24uanM/NmVhYiIsIndlYnBhY2s6Ly9xdWl6Z2FtZS8uL3NlcnZpY2UvY2F0ZWdvcmllc0ZldGNoZXIuanM/NGQ4NiIsIndlYnBhY2s6Ly9xdWl6Z2FtZS8uL3VpL3VzZXJJbnRlcmZhY2UuanM/NjdjYSIsIndlYnBhY2s6Ly9xdWl6Z2FtZS8uL2dhbWUvdGltZXIuanM/OWM4NiIsIndlYnBhY2s6Ly9xdWl6Z2FtZS8uL21vZGVsL2dhbWVEZXRhaWxzLmpzP2NmNjgiLCJ3ZWJwYWNrOi8vcXVpemdhbWUvLi9nYW1lL2dhbWUuanM/NmQ4NCIsIndlYnBhY2s6Ly9xdWl6Z2FtZS8uL3F1aXpHYW1lLmpzPzFkY2YiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEM7O0FDUGU7QUFDZjtBQUNBLDZEQUE2RCxhQUFhLFlBQVksU0FBUyxjQUFjLFdBQVc7QUFDeEg7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLEM7O0FDVmU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsQzs7QUNkZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsQzs7QUNWNkQ7O0FBRTdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVlO0FBQ2Y7QUFDQSxxQ0FBcUMsaUJBQWlCO0FBQ3REO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLCtCQUErQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtB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QUFNLGlCQUFROztBQUVkO0FBQ0EscUJBQXFCLElBQUk7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjEyMi5qcyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFuc3dlckRldGFpbHMge1xuICAgIGNvbnN0cnVjdG9yKGFuc3dlclRpbWUsIGlzQW5zd2VyZWQsIGFuc3dlciwgc2NvcmUpIHtcbiAgICAgICAgdGhpcy5hbnN3ZXJUaW1lID0gYW5zd2VyVGltZTtcbiAgICAgICAgdGhpcy5pc0Fuc3dlcmVkID0gaXNBbnN3ZXJlZDtcbiAgICAgICAgdGhpcy5hbnN3ZXIgPSBhbnN3ZXI7XG4gICAgICAgIHRoaXMuc2NvcmUgPSBzY29yZTtcbiAgICB9XG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUXVlc3Rpb25zRmV0Y2hlciB7XG4gICAgYXN5bmMgZmV0Y2hRdWVzdGlvbnMocXVlc3Rpb25zTnVtLCBjYXRlZ29yeSwgZGlmZmljdWx0eSkge1xuICAgICAgICBjb25zdCBhcGlVUkwgPSBgaHR0cHM6Ly9vcGVudGRiLmNvbS9hcGkucGhwP2Ftb3VudD0ke3F1ZXN0aW9uc051bX0mY2F0ZWdvcnk9JHtjYXRlZ29yeX0mZGlmZmljdWx0eT0ke2RpZmZpY3VsdHl9JnR5cGU9bXVsdGlwbGVgO1xuICAgICAgICByZXR1cm4gZmV0Y2goYXBpVVJMKVxuICAgICAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gcmVzcG9uc2UuanNvbigpKSBcbiAgICAgICAgICAgIC50aGVuKGRhdGE9PntcbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0YS5yZXN1bHRzO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaChlcnJvciA9PiBhbGVydChlcnJvcikpO1xuICAgIH1cbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBRdWVzdGlvbiB7XG4gICAgY29uc3RydWN0b3IocmVzcG9uc2VPYmopIHtcbiAgICAgICAgdGhpcy5jYXRlZ29yeSA9IHJlc3BvbnNlT2JqLmNhdGVnb3J5O1xuICAgICAgICB0aGlzLnR5cGUgPSByZXNwb25zZU9iai50eXBlO1xuICAgICAgICB0aGlzLmRpZmZpY3VsdHkgPSByZXNwb25zZU9iai5kaWZmaWN1bHR5O1xuICAgICAgICB0aGlzLnF1ZXN0aW9uID0gcmVzcG9uc2VPYmoucXVlc3Rpb247XG4gICAgICAgIHRoaXMuY29ycmVjdEFuc3dlciA9IHJlc3BvbnNlT2JqLmNvcnJlY3RfYW5zd2VyO1xuICAgICAgICB0aGlzLmluY29ycmVjdEFuc3dlcnMgPSByZXNwb25zZU9iai5pbmNvcnJlY3RfYW5zd2VycztcbiAgICAgICAgdGhpcy5hbnN3ZXJEZXRhaWxzID0ge307XG4gICAgfVxuXG4gICAgc2V0QW5zd2VyRGV0YWlscyhhbnN3ZXJEZXRhaWxzKSB7XG4gICAgICAgIHRoaXMuYW5zd2VyRGV0YWlscyA9IGFuc3dlckRldGFpbHM7XG4gICAgfVxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhdGVnb3JpZXNGZXRjaGVyIHtcbiAgICBhc3luYyBmZXRjaENhdGVnb3JpZXMoKSB7XG4gICAgICAgIGNvbnN0IGFwaVVSTCA9IFwiaHR0cHM6Ly9vcGVudGRiLmNvbS9hcGlfY2F0ZWdvcnkucGhwXCI7XG4gICAgICAgIHJldHVybiBmZXRjaChhcGlVUkwpXG4gICAgICAgICAgICAudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS5qc29uKCkpIFxuICAgICAgICAgICAgLnRoZW4oZGF0YT0+e1xuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhLnRyaXZpYV9jYXRlZ29yaWVzO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaChlcnJvciA9PiBhbGVydChlcnJvcikpO1xuICAgIH1cbn0iLCJpbXBvcnQgQ2F0ZWdvcmllc0ZldGNoZXIgZnJvbSBcIi4uL3NlcnZpY2UvY2F0ZWdvcmllc0ZldGNoZXJcIjtcblxuY29uc3QgY2F0ZWdvcmllcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2F0ZWdvcnlcIik7XG5jb25zdCBxdWVzdGlvbnNOdW0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInF1YW50aXR5XCIpO1xuY29uc3QgcHJvcGVydGllcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJvcGVydGllc1wiKTtcbmNvbnN0IHByb2dyZXNzQmFyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwcm9ncmVzc0JhclwiKTtcbmNvbnN0IHF1ZXN0aW9uc0RpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicXVlc3Rpb25zXCIpO1xuY29uc3QgcXVlc3Rpb25EaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInF1ZXN0aW9uXCIpO1xuY29uc3Qgc3VtbWFyeURpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic3VtbWFyeVwiKTtcbmNvbnN0IHN1bW1hcnlBbnN3ZXJzRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhbnN3ZXJzU3VtbWFyeVwiKTtcbmNvbnN0IHF1ZXN0aW9uRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wicXVlc3Rpb25Gb3JtXCJdO1xuY29uc3QgdGltZXJEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRpbWVyXCIpO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW50ZXJmYWNlIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5jYXRlZ29yaWVzRmV0Y2hlciA9IG5ldyBDYXRlZ29yaWVzRmV0Y2hlcigpO1xuICAgICAgICB0aGlzLnRpbWVyU2VjID0gMTtcbiAgICB9XG5cbiAgICBhc3luYyBwb3B1bGF0ZUNhdGVnb3JpZXMoKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuY2F0ZWdvcmllc0ZldGNoZXIuZmV0Y2hDYXRlZ29yaWVzKClcbiAgICAgICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHtyZXNwb25zZS5mb3JFYWNoKG9iaiA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IG9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJvcHRpb25cIik7XG4gICAgICAgICAgICAgICAgb3B0aW9uLnRleHQgPSBvYmoubmFtZTtcbiAgICAgICAgICAgICAgICBvcHRpb24udmFsdWUgPSBvYmouaWQ7XG4gICAgICAgICAgICAgICAgY2F0ZWdvcmllcy5hZGQob3B0aW9uKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBhc3luYyBwb3B1bGF0ZVF1ZXN0aW9uTnVtcygpIHtcbiAgICAgICAgZm9yKGxldCBpPTU7IGk8MjY7IGkrKykge1xuICAgICAgICAgICAgbGV0IG9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJvcHRpb25cIik7XG4gICAgICAgICAgICBvcHRpb24udGV4dCA9IGk7XG4gICAgICAgICAgICBvcHRpb24udmFsdWUgPSBpO1xuICAgICAgICAgICAgcXVlc3Rpb25zTnVtLmFkZChvcHRpb24pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXN5bmMgcHJlcGFyZVByb3BlcnRpZXNTY3JlZW4oKSB7XG4gICAgICAgIHByb3BlcnRpZXMuY2xhc3NMaXN0LnJlbW92ZShcImhpZGVcIik7XG4gICAgICAgIHN1bW1hcnlEaXYuY2xhc3NMaXN0LmFkZChcImhpZGVcIik7XG4gICAgICAgIHN1bW1hcnlBbnN3ZXJzRGl2LmNsYXNzTGlzdC5hZGQoXCJoaWRlXCIpO1xuICAgICAgICBzdW1tYXJ5QW5zd2Vyc0Rpdi5pbm5lckhUTUwgPSBcIlwiO1xuICAgIH1cblxuICAgIGFzeW5jIHByZXBhcmVRdWVzdGlvblNjcmVlbigpIHtcbiAgICAgICAgcHJvcGVydGllcy5jbGFzc0xpc3QuYWRkKFwiaGlkZVwiKTtcbiAgICAgICAgcHJvZ3Jlc3NCYXIuY2xhc3NMaXN0LnJlbW92ZShcImhpZGVcIik7XG4gICAgICAgIHF1ZXN0aW9ucy5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZVwiKTtcbiAgICB9XG5cbiAgICBhc3luYyBwcmVwYXJlUXVlc3Rpb25zU2NyZWVuV2hlblJlcGxheSgpIHtcbiAgICAgICAgc3VtbWFyeURpdi5jbGFzc0xpc3QuYWRkKFwiaGlkZVwiKTtcbiAgICAgICAgc3VtbWFyeUFuc3dlcnNEaXYuY2xhc3NMaXN0LmFkZChcImhpZGVcIik7XG4gICAgICAgIHN1bW1hcnlBbnN3ZXJzRGl2LmlubmVySFRNTCA9IFwiXCI7XG4gICAgfVxuXG4gICAgYXN5bmMgcHJlcGFyZVN1bW1hcnlTY3JlZW4ocXVlc3Rpb25zLCBnYW1lRGV0YWlscykge1xuICAgICAgICBwcm9ncmVzc0Jhci5jbGFzc0xpc3QuYWRkKFwiaGlkZVwiKTtcbiAgICAgICAgcXVlc3Rpb25zRGl2LmNsYXNzTGlzdC5hZGQoXCJoaWRlXCIpO1xuICAgICAgICBzdW1tYXJ5RGl2LmNsYXNzTGlzdC5yZW1vdmUoXCJoaWRlXCIpO1xuICAgICAgICBzdW1tYXJ5QW5zd2Vyc0Rpdi5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZVwiKTtcbiAgICAgICAgdGhpcy5jcmVhdGVBbnN3ZXJzU3VtbWFyeShxdWVzdGlvbnMpO1xuICAgICAgICB0aGlzLmRpc3BsYXlHYW1lRGV0YWlscyhnYW1lRGV0YWlscyk7XG4gICAgfVxuXG4gICAgYXN5bmMgc2hvd1F1ZXN0aW9uKHF1ZXN0aW9uLCBxdWVzdGlvbk51bSwgY3VycmVudFF1ZXN0aW9uTnVtKSB7XG4gICAgICAgIHF1ZXN0aW9uRGl2LmlubmVySFRNTCA9IHF1ZXN0aW9uLnF1ZXN0aW9uO1xuICAgICAgICBsZXQgYWxsQW5zd2VycyA9IHRoaXMuZ2V0QWxsQW5zd2VycyhxdWVzdGlvbik7XG4gICAgICAgIHF1ZXN0aW9uRm9ybS5pbm5lckhUTUwgPSBcIlwiO1xuICAgICAgICB0aGlzLmNyZWF0ZUFuc3dlcnMoYWxsQW5zd2Vycyk7XG4gICAgICAgIHRoaXMuaW5jcmVzZVByb2dyZXNzQmFyKHF1ZXN0aW9uTnVtLCBjdXJyZW50UXVlc3Rpb25OdW0pXG4gICAgfVxuXG4gICAgaW5jcmVzZVByb2dyZXNzQmFyKHF1ZXN0aW9uTnVtLCBjdXJyZW50UXVlc3Rpb25OdW0pIHtcbiAgICAgICAgY29uc3QgcHJvZ3Jlc3NWYWx1ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJvZ3Jlc3NWYWx1ZVwiKTtcbiAgICAgICAgY29uc3QgY2FsY3VsYXRlZFdpZHRoID0gKGN1cnJlbnRRdWVzdGlvbk51bSAvIHF1ZXN0aW9uTnVtKSAqIDEwMDtcbiAgICAgICAgY29uc3Qgd2lkdGhWYWx1ZSA9IGNhbGN1bGF0ZWRXaWR0aCArIFwiJVwiO1xuICAgICAgICBwcm9ncmVzc1ZhbHVlLnN0eWxlLndpZHRoID0gd2lkdGhWYWx1ZTtcbiAgICB9XG5cbiAgICBzaHVmZmxlQXJyYXkoYXJyYXkpIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IGFycmF5Lmxlbmd0aCAtIDE7IGkgPiAwOyBpLS0pIHtcbiAgICAgICAgICAgIGxldCBqID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKGkgKyAxKSk7XG4gICAgICAgICAgICBsZXQgdGVtcCA9IGFycmF5W2ldO1xuICAgICAgICAgICAgYXJyYXlbaV0gPSBhcnJheVtqXTtcbiAgICAgICAgICAgIGFycmF5W2pdID0gdGVtcDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGNyZWF0ZVJhZGlvQm94KGFuc3dlciwgaWQpIHtcbiAgICAgICAgbGV0IHJhZGlvYm94ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgICAgICAgcmFkaW9ib3guaWQgPSBpZDtcbiAgICAgICAgcmFkaW9ib3gudHlwZSA9ICdyYWRpbyc7XG4gICAgICAgIHJhZGlvYm94LnZhbHVlID0gYW5zd2VyO1xuICAgICAgICByYWRpb2JveC5uYW1lID0gXCJhbnN3ZXJcIlxuICAgICAgICByZXR1cm4gcmFkaW9ib3g7XG4gICAgfVxuXG4gICAgY3JlYXRlTGFiZWwoYW5zd2VyLCBpZCkge1xuICAgICAgICBjb25zdCBsYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xhYmVsJylcbiAgICAgICAgbGFiZWwuaHRtbEZvciA9IGlkO1xuICAgICAgICBjb25zdCBkZXNjcmlwdGlvbiA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGFuc3dlcik7XG4gICAgICAgIGxhYmVsLmFwcGVuZENoaWxkKGRlc2NyaXB0aW9uKTtcbiAgICAgICAgcmV0dXJuIGxhYmVsO1xuICAgIH1cblxuICAgIGNyZWF0ZUFuc3dlckdyb3VwKHJhZGlvYm94LCBsYWJlbCkge1xuICAgICAgICBjb25zdCBhbnN3ZXJHcm91cCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgIGFuc3dlckdyb3VwLmNsYXNzTGlzdC5hZGQoXCJhbnN3ZXJHcm91cFwiKTtcbiAgICAgICAgXG4gICAgICAgIGFuc3dlckdyb3VwLmFwcGVuZENoaWxkKHJhZGlvYm94KTtcbiAgICAgICAgYW5zd2VyR3JvdXAuYXBwZW5kQ2hpbGQobGFiZWwpO1xuICAgICAgICByZXR1cm4gYW5zd2VyR3JvdXA7XG4gICAgfVxuXG4gICAgZ2V0QWxsQW5zd2VycyhxdWVzdGlvbikge1xuICAgICAgICBjb25zdCBhbGxBbnN3ZXJzID0gcXVlc3Rpb24uaW5jb3JyZWN0QW5zd2VycztcbiAgICAgICAgYWxsQW5zd2Vycy5wdXNoKHF1ZXN0aW9uLmNvcnJlY3RBbnN3ZXIpO1xuICAgICAgICB0aGlzLnNodWZmbGVBcnJheShhbGxBbnN3ZXJzKTtcbiAgICAgICAgcmV0dXJuIGFsbEFuc3dlcnM7XG4gICAgfVxuXG4gICAgY3JlYXRlQW5zd2VycyhhbGxBbnN3ZXJzKSB7XG4gICAgICAgIGxldCByYWRpb2JveElkID0gMDtcbiAgICAgICAgYWxsQW5zd2Vycy5mb3JFYWNoKGFuc3dlciA9PiB7XG4gICAgICAgICAgICBjb25zdCByYWRpb2JveCA9IHRoaXMuY3JlYXRlUmFkaW9Cb3goYW5zd2VyLCByYWRpb2JveElkKTtcbiAgICAgICAgICAgIGNvbnN0IGxhYmVsID0gdGhpcy5jcmVhdGVMYWJlbChhbnN3ZXIsIHJhZGlvYm94SWQpO1xuICAgICAgICAgICAgY29uc3QgYW5zd2VyR3JvdXAgPSB0aGlzLmNyZWF0ZUFuc3dlckdyb3VwKHJhZGlvYm94LCBsYWJlbCk7XG4gICAgICAgICAgICBxdWVzdGlvbkZvcm0uYXBwZW5kQ2hpbGQoYW5zd2VyR3JvdXApO1xuICAgICAgICAgICAgcmFkaW9ib3hJZCsrO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBnZXRTZWxlY3RlZFJhZGlvVmFsdWUoKSB7XG4gICAgICAgIGxldCBzZWxlY3RlZEFuc3dlciA9IFwiXCI7XG4gICAgICAgIHF1ZXN0aW9uRm9ybVtcImFuc3dlclwiXS5mb3JFYWNoKGFuc3dlciA9PiB7XG4gICAgICAgICAgICBpZihhbnN3ZXIuY2hlY2tlZCkgc2VsZWN0ZWRBbnN3ZXIgPSBhbnN3ZXIudmFsdWU7XG4gICAgICAgIH0pO1xuICAgICAgICBpZihzZWxlY3RlZEFuc3dlciA9PT0gXCJcIikgYWxlcnQoXCJQbGVhc2Ugc2VsZWN0IGFuIGFuc3dlciBvciBza2lwIHRoZSBxdWVzdGlvbi5cIilcbiAgICAgICAgcmV0dXJuIHNlbGVjdGVkQW5zd2VyO1xuICAgIH1cblxuICAgIGRpc3BsYXlHYW1lRGV0YWlscyhnYW1lRGV0YWlscykge1xuICAgICAgICBjb25zdCB0b3RhbFNjb3JlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0b3RhbFNjb3JlXCIpO1xuICAgICAgICBjb25zdCB0b3RhbFRpbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRvdGFsVGltZVwiKTtcbiAgICAgICAgY29uc3QgdGltZUluTWlsaXMgPSBnYW1lRGV0YWlscy50b3RhbFRpbWVyLmdldE1pbGlzZWNvbmRzRnJvbVN0YXJ0KCk7XG4gICAgICAgIGNvbnN0IHRpbWVJbnNTZWMgPSBNYXRoLmZsb29yKHRpbWVJbk1pbGlzLzEwMDApO1xuICAgICAgICB0b3RhbFNjb3JlLmlubmVySFRNTCA9IGdhbWVEZXRhaWxzLnRvdGFsU2NvcmU7XG4gICAgICAgIHRvdGFsVGltZS5pbm5lckhUTUwgPSBgJHtNYXRoLmZsb29yKHRpbWVJbnNTZWMvNjApfToke3RpbWVJbnNTZWMlNjB9YDtcbiAgICB9XG5cbiAgICBjcmVhdGVBbnN3ZXJzU3VtbWFyeShxdWVzdGlvbnMpIHtcbiAgICAgICAgcXVlc3Rpb25zLmZvckVhY2gocXVlc3Rpb24gPT4ge1xuICAgICAgICAgICAgY29uc3Qgc2NvcmVTZWN0aW9uU2NvcmUgPSB0aGlzLmNyZWF0ZVNjb3JlU2VjdGlvbihcIlNjb3JlOlwiLCBxdWVzdGlvbi5hbnN3ZXJEZXRhaWxzLnNjb3JlKTtcbiAgICAgICAgICAgIGNvbnN0IGFuc3dlclRpbWUgPSBxdWVzdGlvbi5hbnN3ZXJEZXRhaWxzLmFuc3dlclRpbWU7XG4gICAgICAgICAgICBjb25zdCBzY29yZVNlY3Rpb25UaW1lID0gdGhpcy5jcmVhdGVTY29yZVNlY3Rpb24oXCJUaW1lOlwiLCBgJHtNYXRoLmZsb29yKGFuc3dlclRpbWUvMTAwMCl9c2ApO1xuICAgICAgICAgICAgY29uc3Qgc3VtbWFyeUluZm8gPSB0aGlzLmNyZWF0ZVN1bW1hcnlJbmZvKHNjb3JlU2VjdGlvblNjb3JlLCBzY29yZVNlY3Rpb25UaW1lKTtcbiAgICAgICAgICAgIGNvbnN0IGFuc3dlckRldGFpbHMgPSB0aGlzLmNyZWF0ZUFuc3dlckRldGFpbHMoc3VtbWFyeUluZm8sIHF1ZXN0aW9uKTtcbiAgICAgICAgICAgIHN1bW1hcnlBbnN3ZXJzRGl2LmFwcGVuZENoaWxkKGFuc3dlckRldGFpbHMpO1xuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgfVxuXG4gICAgY3JlYXRlQW5zd2VyRGV0YWlscyhzdW1tYXJ5SW5mbywgcXVlc3Rpb24pIHtcbiAgICAgICAgY29uc3QgYW5zd2VyRGV0YWlscyA9IHRoaXMuZ2V0RGl2KFwic3VtbWFyeURpdlwiLCBcIlwiKTtcbiAgICAgICAgYW5zd2VyRGV0YWlscy5hcHBlbmRDaGlsZCh0aGlzLmdldERpdihcInF1ZXN0aW9uXCIsIHF1ZXN0aW9uLnF1ZXN0aW9uKSk7XG4gICAgICAgIGFuc3dlckRldGFpbHMuYXBwZW5kQ2hpbGQodGhpcy5nZXRIcigpKTtcbiAgICAgICAgYW5zd2VyRGV0YWlscy5hcHBlbmRDaGlsZCh0aGlzLmdldERpdihcInF1ZXN0aW9uXCIsIFwiWW91ciBhbnN3ZXI6IFwiICsgcXVlc3Rpb24uYW5zd2VyRGV0YWlscy5hbnN3ZXIpKTtcbiAgICAgICAgYW5zd2VyRGV0YWlscy5hcHBlbmRDaGlsZCh0aGlzLmdldEhyKCkpO1xuICAgICAgICBhbnN3ZXJEZXRhaWxzLmFwcGVuZENoaWxkKHRoaXMuZ2V0RGl2KFwicXVlc3Rpb25cIiwgXCJDb3JyZWN0IGFuc3dlcjogXCIgKyBxdWVzdGlvbi5jb3JyZWN0QW5zd2VyKSk7XG4gICAgICAgIGFuc3dlckRldGFpbHMuYXBwZW5kQ2hpbGQodGhpcy5nZXRIcigpKTtcbiAgICAgICAgYW5zd2VyRGV0YWlscy5hcHBlbmRDaGlsZChzdW1tYXJ5SW5mbyk7XG4gICAgICAgIHJldHVybiBhbnN3ZXJEZXRhaWxzO1xuICAgIH1cblxuICAgIGNyZWF0ZVN1bW1hcnlJbmZvKHNlY3Rpb25TY29yZSwgc2VjdGlvblRpbWUpIHtcbiAgICAgICAgY29uc3Qgc3VtbWFyeUluZm8gPSB0aGlzLmdldERpdihcInN1bW1hcnlJbmZvRGl2XCIsIFwiXCIpO1xuICAgICAgICBzdW1tYXJ5SW5mby5hcHBlbmRDaGlsZChzZWN0aW9uU2NvcmUpO1xuICAgICAgICBzdW1tYXJ5SW5mby5hcHBlbmRDaGlsZChzZWN0aW9uVGltZSk7XG4gICAgICAgIHJldHVybiBzdW1tYXJ5SW5mbztcbiAgICB9XG5cbiAgICBjcmVhdGVTY29yZVNlY3Rpb24obGFiZWxOYW1lLCB2YWx1ZSkge1xuICAgICAgICBjb25zdCBsYWJlbCA9IHRoaXMuZ2V0TGFiZWwobGFiZWxOYW1lKTtcbiAgICAgICAgY29uc3QgdmFsdWVEaXYgPSB0aGlzLmdldERpdihcImFuc3dlclNjb3JlXCIsIHZhbHVlKTtcbiAgICAgICAgY29uc3Qgc2NvcmVTZWN0aW9uID0gdGhpcy5nZXREaXYoXCJzY29yZVNlY3Rpb25cIiwgXCJcIik7XG4gICAgICAgIHNjb3JlU2VjdGlvbi5hcHBlbmRDaGlsZChsYWJlbCk7XG4gICAgICAgIHNjb3JlU2VjdGlvbi5hcHBlbmRDaGlsZCh2YWx1ZURpdik7XG4gICAgICAgIHJldHVybiBzY29yZVNlY3Rpb247XG4gICAgfVxuXG4gICAgZ2V0SHIoKSB7XG4gICAgICAgIHJldHVybiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaHJcIik7XG4gICAgfVxuXG4gICAgZ2V0RGl2KGNsYXNzTmFtZSwgaW5uZXJIVE1MKSB7XG4gICAgICAgIGNvbnN0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgIGRpdi5jbGFzc0xpc3QuYWRkKGNsYXNzTmFtZSk7XG4gICAgICAgIGRpdi5pbm5lckhUTUwgPSBpbm5lckhUTUw7XG4gICAgICAgIHJldHVybiBkaXY7XG4gICAgfVxuXG4gICAgZ2V0TGFiZWwoaW5uZXJIVE1MKSB7XG4gICAgICAgIGNvbnN0IGxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxhYmVsXCIpO1xuICAgICAgICBsYWJlbC5pbm5lckhUTUwgPSBpbm5lckhUTUw7XG4gICAgICAgIHJldHVybiBsYWJlbDtcbiAgICB9XG5cbiAgICBzdGFydFF1ZXN0aW9uVGltZXIoKSB7XG4gICAgICAgIGNvbnN0IG1pbnV0ZXMgPSBNYXRoLmZsb29yKHRoaXMudGltZXJTZWMvNjApO1xuICAgICAgICB0aW1lckRpdi5pbm5lckhUTUwgPSBtaW51dGVzICsgXCI6XCIgKyB0aGlzLnRpbWVyU2VjJTYwO1xuICAgICAgICB0aGlzLnRpbWVyU2VjICsrO1xuICAgIH1cbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBUaW1lciB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuc3RhcnQgPSBuZXcgRGF0ZSgpO1xuICAgIH1cblxuICAgIGdldE1pbGlzZWNvbmRzRnJvbVN0YXJ0KCkge1xuICAgICAgICBsZXQgc3RvcCA9IG5ldyBEYXRlKCk7XG4gICAgICAgIHJldHVybiBzdG9wLmdldFRpbWUoKSAtIHRoaXMuc3RhcnQuZ2V0VGltZSgpO1xuICAgIH1cbn0iLCJpbXBvcnQgVGltZXIgZnJvbSBcIi4uL2dhbWUvdGltZXJcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgR2FtZURldGFpbHMge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLnRvdGFsVGltZXIgPSBuZXcgVGltZXIoKTtcbiAgICAgICAgdGhpcy50b3RhbFNjb3JlID0gMDtcbiAgICB9XG59IiwiaW1wb3J0IEFuc3dlckRldGFpbHMgZnJvbSBcIi4uL21vZGVsL2Fuc3dlckRldGFpbHNcIlxuaW1wb3J0IFF1ZXN0aW9uc0ZldGNoZXIgZnJvbSBcIi4uL3NlcnZpY2UvcXVlc3Rpb25zRmV0Y2hlclwiO1xuaW1wb3J0IFF1ZXN0aW9uIGZyb20gXCIuLi9tb2RlbC9xdWVzdGlvblwiO1xuaW1wb3J0IFVzZXJJbnRlcmZhY2UgZnJvbSBcIi4uL3VpL3VzZXJJbnRlcmZhY2VcIjtcbmltcG9ydCBUaW1lciBmcm9tIFwiLi90aW1lclwiO1xuaW1wb3J0IEdhbWVEZXRhaWxzIGZyb20gXCIuLi9tb2RlbC9nYW1lRGV0YWlsc1wiO1xuXG5jb25zdCBwcm9wZXJ0aWVzRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wicHJvcGVydGllc0Zvcm1cIl07XG5jb25zdCBib251c1RpbWUgPSA1MDAwO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHYW1lIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5xdWVzdGlvbnMgPSBbXTtcbiAgICAgICAgdGhpcy5jdXJyZW50UXVlc3Rpb25OdW0gPSAtMTtcbiAgICAgICAgdGhpcy51c2VySW50ZXJmYWNlID0gbmV3IFVzZXJJbnRlcmZhY2UoKTtcbiAgICAgICAgdGhpcy5xdWVzdGlvbkZldGNoZXIgPSBuZXcgUXVlc3Rpb25zRmV0Y2hlcigpO1xuICAgICAgICB0aGlzLnF1ZXN0aW9uVGltZXIgPSB7fTtcbiAgICAgICAgdGhpcy5nYW1lRGV0YWlscyA9IHt9O1xuICAgIH1cblxuICAgIGFzeW5jIHN0YXJ0R2FtZSgpIHtcbiAgICAgICAgdGhpcy51c2VySW50ZXJmYWNlLnBvcHVsYXRlQ2F0ZWdvcmllcygpO1xuICAgICAgICB0aGlzLnVzZXJJbnRlcmZhY2UucG9wdWxhdGVRdWVzdGlvbk51bXMoKTtcbiAgICB9XG5cbiAgICBhc3luYyBwbGF5QWdhaW4oKSB7XG4gICAgICAgIHRoaXMucHJlcGFyZVRvTmV3R2FtZSgpO1xuICAgICAgICB0aGlzLnN1Ym1pdFByb3BlcnRpZXMoKTtcbiAgICAgICAgdGhpcy51c2VySW50ZXJmYWNlLnByZXBhcmVRdWVzdGlvbnNTY3JlZW5XaGVuUmVwbGF5KCk7XG4gICAgfVxuXG4gICAgYXN5bmMgc3RhcnROZXdHYW1lKCkge1xuICAgICAgICB0aGlzLnByZXBhcmVUb05ld0dhbWUoKTtcbiAgICAgICAgdGhpcy51c2VySW50ZXJmYWNlLnByZXBhcmVQcm9wZXJ0aWVzU2NyZWVuKCk7XG4gICAgfVxuXG4gICAgcHJlcGFyZVRvTmV3R2FtZSgpIHtcbiAgICAgICAgdGhpcy5xdWVzdGlvbnMgPSBbXTtcbiAgICAgICAgdGhpcy5jdXJyZW50UXVlc3Rpb25OdW0gPSAtMTtcbiAgICB9XG4gICAgICAgIFxuICAgIGFzeW5jIHN1Ym1pdFByb3BlcnRpZXMoKSB7XG4gICAgICAgIHRoaXMuZ2FtZURldGFpbHMgPSBuZXcgR2FtZURldGFpbHMoKTtcbiAgICAgICAgY29uc3QgcXVlc3Rpb25zTnVtID0gcHJvcGVydGllc0Zvcm1bXCJxdWFudGl0eVwiXS52YWx1ZTtcbiAgICAgICAgY29uc3QgY2F0ZWdvcnkgPSBwcm9wZXJ0aWVzRm9ybVtcImNhdGVnb3J5XCJdLnZhbHVlO1xuICAgICAgICBjb25zdCBkaWZmaWN1bHR5ID0gcHJvcGVydGllc0Zvcm1bXCJkaWZmaWN1bHR5XCJdLnZhbHVlO1xuICAgICAgICBhd2FpdCB0aGlzLnNhdmVRdWVzdGlvbnMocXVlc3Rpb25zTnVtLCBjYXRlZ29yeSwgZGlmZmljdWx0eSk7XG4gICAgICAgIHRoaXMudXNlckludGVyZmFjZS5wcmVwYXJlUXVlc3Rpb25TY3JlZW4oKTtcbiAgICAgICAgdGhpcy5sb2FkTmV4dFF1ZXN0aW9uKCk7XG4gICAgfVxuXG4gICAgYXN5bmMgc2F2ZVF1ZXN0aW9ucyhxdWVzdGlvbnNOdW0sIGNhdGVnb3J5LCBkaWZmaWN1bHR5KSB7XG4gICAgICAgIGF3YWl0IHRoaXMucXVlc3Rpb25GZXRjaGVyLmZldGNoUXVlc3Rpb25zKHF1ZXN0aW9uc051bSwgY2F0ZWdvcnksIGRpZmZpY3VsdHkpXG4gICAgICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgICAgICAgICAgcmVzcG9uc2UuZm9yRWFjaChvYmogPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnF1ZXN0aW9ucy5wdXNoKG5ldyBRdWVzdGlvbihvYmopKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBsb2FkTmV4dFF1ZXN0aW9uKCkge1xuICAgICAgICBpZih0aGlzLmN1cnJlbnRRdWVzdGlvbk51bSA8IHRoaXMucXVlc3Rpb25zLmxlbmd0aCkge1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50UXVlc3Rpb25OdW0gKys7XG4gICAgICAgICAgICB0aGlzLnVzZXJJbnRlcmZhY2Uuc2hvd1F1ZXN0aW9uKHRoaXMucXVlc3Rpb25zW3RoaXMuY3VycmVudFF1ZXN0aW9uTnVtXSwgdGhpcy5xdWVzdGlvbnMubGVuZ3RoLCB0aGlzLmN1cnJlbnRRdWVzdGlvbk51bSk7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0VGltZXIoKTtcbiAgICAgICAgICAgIHRoaXMucHJlcGFyZVZpc2libGVUaW1lcigpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJlcGFyZVZpc2libGVUaW1lcigpIHtcbiAgICAgICAgdGhpcy51c2VySW50ZXJmYWNlLnRpbWVyU2VjID0gMTtcbiAgICAgICAgY29uc3QgdGltZXJEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRpbWVyXCIpO1xuICAgICAgICB0aW1lckRpdi5pbm5lckhUTUwgPSBcIjA6MFwiO1xuICAgIH1cblxuICAgIHN0YXJ0VGltZXIoKSB7XG4gICAgICAgIHRoaXMucXVlc3Rpb25UaW1lciA9IG5ldyBUaW1lcigpO1xuICAgICAgICByZXR1cm4gdGltZXI7XG4gICAgfVxuXG4gICAgc3RhcnRWaXNpYmxlVGltZXIoKSB7XG4gICAgICAgIHRoaXMudXNlckludGVyZmFjZS5zdGFydFF1ZXN0aW9uVGltZXIoKTtcbiAgICB9XG5cbiAgICBhbnN3ZXIoaXNBbnN3ZXJlZCkge1xuICAgICAgICBjb25zdCBhbnN3ZXIgPSB0aGlzLmdldEFuc3dlcihpc0Fuc3dlcmVkKTtcbiAgICAgICAgY29uc3QgaXNBbnN3ZXJOb3RDaGVja2VkID0gKGlzQW5zd2VyZWQgJiYgYW5zd2VyID09XCJcIik7XG4gICAgICAgIGlmKCFpc0Fuc3dlck5vdENoZWNrZWQpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0QW5zd2VyRGV0YWlscyhpc0Fuc3dlcmVkLCBhbnN3ZXIpO1xuICAgICAgICAgICAgdGhpcy5zZXRUb3RhbFNjb3JlKCk7XG4gICAgICAgICAgICB0aGlzLmxvYWROZXh0U2NyZWVuKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzZXRBbnN3ZXJEZXRhaWxzKGlzQW5zd2VyZWQsIGFuc3dlcikge1xuICAgICAgICBjb25zdCB0aW1lID0gdGhpcy5xdWVzdGlvblRpbWVyLmdldE1pbGlzZWNvbmRzRnJvbVN0YXJ0KCk7XG4gICAgICAgIGNvbnN0IGNvcnJlY3RBbnN3ZXIgPSB0aGlzLnF1ZXN0aW9uc1t0aGlzLmN1cnJlbnRRdWVzdGlvbk51bV0uY29ycmVjdEFuc3dlcjtcbiAgICAgICAgbGV0IHNjb3JlID0gdGhpcy5nZXRTY29yZShpc0Fuc3dlcmVkLCBhbnN3ZXIsIGNvcnJlY3RBbnN3ZXIsIHRpbWUpO1xuICAgICAgICBjb25zdCBhbnN3ZXJEZXRhaWxzID0gbmV3IEFuc3dlckRldGFpbHModGltZSwgaXNBbnN3ZXJlZCwgYW5zd2VyLCBzY29yZSk7XG4gICAgICAgIHRoaXMucXVlc3Rpb25zW3RoaXMuY3VycmVudFF1ZXN0aW9uTnVtXS5zZXRBbnN3ZXJEZXRhaWxzKGFuc3dlckRldGFpbHMpO1xuICAgIH1cblxuICAgIGdldEFuc3dlcihpc0Fuc3dlcmVkKSB7XG4gICAgICAgIGxldCBhbnN3ZXIgPSBcIlwiO1xuICAgICAgICBpZihpc0Fuc3dlcmVkKSBhbnN3ZXIgPSB0aGlzLnVzZXJJbnRlcmZhY2UuZ2V0U2VsZWN0ZWRSYWRpb1ZhbHVlKCk7XG4gICAgICAgIHJldHVybiBhbnN3ZXI7XG4gICAgfVxuXG4gICAgZ2V0U2NvcmUoaXNBbnN3ZXJlZCwgYW5zd2VyLCBjb3JyZWN0QW5zd2VyLCB0aW1lKSB7XG4gICAgICAgIGxldCBzY29yZSA9IDA7XG4gICAgICAgIGlmKGlzQW5zd2VyZWQpIHNjb3JlID0gdGhpcy5jYWxjdWxhdGVTY29yZShhbnN3ZXIsIGNvcnJlY3RBbnN3ZXIsIHRpbWUpO1xuICAgICAgICByZXR1cm4gc2NvcmU7XG4gICAgfVxuXG4gICAgc2V0VG90YWxTY29yZSgpIHtcbiAgICAgICAgY29uc3QgY3VycmVudFF1ZXN0aW9uID0gdGhpcy5xdWVzdGlvbnNbdGhpcy5jdXJyZW50UXVlc3Rpb25OdW1dO1xuICAgICAgICBjb25zdCBjdXJyZW50UXVlc3Rpb25TY29yZSA9IGN1cnJlbnRRdWVzdGlvbi5hbnN3ZXJEZXRhaWxzLnNjb3JlO1xuICAgICAgICB0aGlzLmdhbWVEZXRhaWxzLnRvdGFsU2NvcmUgKz0gY3VycmVudFF1ZXN0aW9uU2NvcmU7XG4gICAgfVxuXG4gICAgbG9hZE5leHRTY3JlZW4oKSB7XG4gICAgICAgIGNvbnN0IGxhc3RRdWVzdGlvbk51bSA9IHRoaXMucXVlc3Rpb25zLmxlbmd0aCAtIDE7XG4gICAgICAgIGlmKHRoaXMuY3VycmVudFF1ZXN0aW9uTnVtIDwgbGFzdFF1ZXN0aW9uTnVtKSB0aGlzLmxvYWROZXh0UXVlc3Rpb24oKTtcbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnVzZXJJbnRlcmZhY2UucHJlcGFyZVN1bW1hcnlTY3JlZW4odGhpcy5xdWVzdGlvbnMsIHRoaXMuZ2FtZURldGFpbHMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY2FsY3VsYXRlU2NvcmUoYW5zd2VyLCBjb3JyZWN0QW5zd2VyLCB0aW1lKSB7XG4gICAgICAgIGxldCBzY29yZSA9IDA7XG4gICAgICAgIGlmKGFuc3dlciA9PT0gY29ycmVjdEFuc3dlcikge1xuICAgICAgICAgICAgc2NvcmUgKz0gMTtcbiAgICAgICAgICAgIGlmKHRpbWUgPCBib251c1RpbWUpIHNjb3JlICs9IDAuNTtcbiAgICAgICAgfSBlbHNlIHNjb3JlIC09IDAuMjU7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gc2NvcmU7XG4gICAgfVxufSIsImltcG9ydCBHYW1lIGZyb20gXCIuL2dhbWUvZ2FtZVwiO1xuXG5jb25zdCBwbGF5QnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwbGF5QnV0dG9uXCIpO1xuY29uc3QgYW5zd2VyQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhbnN3ZXJCdXR0b25cIik7XG5jb25zdCBza2lwQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJza2lwQnV0dG9uXCIpO1xuY29uc3QgcGxheUFnYWluQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwbGF5QWdhaW5CdXR0b25cIik7XG5jb25zdCBuZXdHYW1lQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJuZXdHYW1lQnV0dG9uXCIpO1xuY29uc3QgdGltZXJEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRpbWVyXCIpO1xuXG5mdW5jdGlvbiBzdGFydEdhbWUoKSB7XG4gICAgY29uc3QgZ2FtZSA9IG5ldyBHYW1lKCk7XG4gICAgZ2FtZS5zdGFydEdhbWUoKTtcbiAgICBwbGF5QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBnYW1lLnN1Ym1pdFByb3BlcnRpZXMoKSk7XG4gICAgYW5zd2VyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBnYW1lLmFuc3dlcih0cnVlKSk7XG4gICAgc2tpcEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gZ2FtZS5hbnN3ZXIoZmFsc2UpKTtcbiAgICBwbGF5QWdhaW5CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGdhbWUucGxheUFnYWluKCkpO1xuICAgIG5ld0dhbWVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGdhbWUuc3RhcnROZXdHYW1lKCkpO1xuICAgIGNvbnN0IHF1ZXN0aW9uVGltZXIgPSBzZXRJbnRlcnZhbCgoKSA9PiBnYW1lLnN0YXJ0VmlzaWJsZVRpbWVyKCksIDEwMDApO1xufVxuXG5zdGFydEdhbWUoKTtcblxuXG5cbi8vIHZhciBxdWVzdGlvblRpbWVyID0gc2V0SW50ZXJ2YWwodGltZXIsIDEwMDApO1xuLy8gdmFyIHNlYyA9IDA7XG4vLyBmdW5jdGlvbiB0aW1lcigpIHtcbi8vICAgICBsZXQgbWludXRlcyA9IE1hdGguZmxvb3Ioc2VjLzYwKTtcbi8vICAgICB0aW1lckRpdi5pbm5lckhUTUwgPSBtaW51dGVzICsgXCI6XCIgKyBzZWMlNjA7XG4vLyAgICAgc2VjICsrO1xuLy8gfSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///122\n')})();